<!doctype html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=bsmaklHF" />
  <link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
  <!-- End Wayback Rewrite JS Include -->
  <title data-rh="true">Building a Rust Driver for PineTime’s Touch Controller</title>
  <meta data-rh="true" charset="utf-8" />
  <meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
  <meta data-rh="true" name="theme-color" content="#000000" />
  <meta data-rh="true" property="og:type" content="article" />
  <meta data-rh="true" property="article:published_time" content="2019-12-15T12:25:45.049Z" />
  <meta data-rh="true" name="title" content="Building a Rust Driver for PineTime’s Touch Controller" />
  <meta data-rh="true" property="og:title" content="Building a Rust Driver for PineTime’s Touch Controller" />
  <meta data-rh="true" property="twitter:title" content="Building a Rust Driver for PineTime’s Touch Controller" />
  <meta data-rh="true" name="description"
    content="Pretend you’re my IoT student. I give you a PineTime Smart Watch and challenge you to “Make it work… Especially the touch screen!” The Touch Screen appears to be lacking some documentation. What…" />
  <meta data-rh="true" property="og:description"
    content="Pretend you’re my IoT student.  I give you a PineTime Smart Watch and challenge you to “Make it work… Especially the touch screen!” The…" />
  <meta data-rh="true" property="twitter:description"
    content="Pretend you’re my IoT student.  I give you a PineTime Smart Watch and challenge you to “Make it work… Especially the touch screen!” The…" />
  <meta data-rh="true" name="twitter:card" content="summary_large_image" />
  <meta data-rh="true" name="twitter:creator" content="@MisterTechBlog" />
  <meta data-rh="true" name="author" content="Lup Yuen Lee 李立源" />
  <meta data-rh="true" name="robots" content="index,follow" />
  <meta data-rh="true" name="referrer" content="unsafe-url" />
  <meta data-rh="true" name="twitter:label1" value="Reading time" />
  <meta data-rh="true" name="twitter:data1" value="10 min read" />
  
<!-- Begin scripts/rustdoc-header.html: Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<link rel="alternate" type="application/rss+xml" title="RSS Feed for lupyuen" href="/rss.xml" />
<link rel="stylesheet" type="text/css" href="../normalize.css">
<link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle">

<link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle">
<link rel="stylesheet" type="text/css" href="../prism.css">
<script src="../storage.js"></script><noscript>
<link rel="stylesheet" href="../noscript.css"></noscript>
<link rel="shortcut icon" href="../favicon.ico">
<style type="text/css">
    #crate-search {
        background-image: url("../down-arrow.svg");
    }
    a {
        color: #77d;
    }
</style>
<!-- End scripts/rustdoc-header.html -->

  </head>

<body>

  <div id="root">
    <div class="a b c">
      <article>
        <section class="cj ck cl cm ak cn ce n co"></section><span class="r"></span>
        <div>
          <div class="cp u cq cr cs ct"></div>
          <section class="cu cv cw cx cy">
            <div class="cz ak">
              
                <div class="db dc dd de ak">
                  <div class="dl r dd dm">
                    <div class="dn r">
                      <div ></div><img src="https://lupyuen.github.io/images/legacy/i1.png"
                         /><noscript></noscript>
                    </div>
                  </div>
                </div>
                <p><em>Testing the Rust and Mynewt OS driver for the
                  Touch Controller on PineTime Smart Watch by Pine64</em></p>
              
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <div>
                  <div id="f022" class="ea eb ec bk ed b ee ef eg eh ei ej ek el em en eo">
                    <h1 class="ed b ee ep eg eq ei er ek es em et ec">Building a Rust Driver for PineTime’s Touch
                      Controller</h1>
                  </div>
                  <div class="eu">
                    <div class="n ev ew ex ey">
                      <div class="o n">
                        <div><a rel="noopener"
                            href="/web/20191222054305/https://medium.com/@ly.lee?source=post_page-----cbc1a5d5d3e9----------------------">
                            <div class="dd ez fa">
                              <div class="bs n fb o p cp fc fd fe ff fg ct"></div><img alt="Lup Yuen Lee 李立源" class="r fh fa ez"
                                src="https://miro.medium.com/fit/c/96/96/1*KGohS3sQaUnr58gc0BIfoQ.jpeg"
                                width="48" height="48" />
                            </div>
                          </a></div>
                        <div class="fi ak r">
                          <div class="n">
                            <div style="flex:1"><span class="bj b bk bl bm bn r ec q">
                                <div class="fj n o fk"><span class="bj dy ds bl di fl fm fn fo fp ec"><a
                                      class="at au av aw ax ay az ba bb bc fq bf bg bh bi" rel="noopener"
                                      href="/web/20191222054305/https://medium.com/@ly.lee?source=post_page-----cbc1a5d5d3e9----------------------">Lup
                                      Yuen Lee 李立源</a></span>
                                
                                </div>
                              </span></div>
                          </div><span class="bj b bk bl bm bn r bo bp"><span class="bj dy ds bl di fl fm fn fo fp bo">
                              <div><a class="at au av aw ax ay az ba bb bc fq bf bg bh bi" rel="noopener"
                                  href="/web/20191222054305/https://medium.com/@ly.lee/building-a-rust-driver-for-pinetimes-touch-controller-cbc1a5d5d3e9?source=post_page-----cbc1a5d5d3e9----------------------">
                                  22 Nov 2019</a> <!-- -->·
                                <!-- -->
                                <!-- -->10
                                <!-- --> min read
                              </div>
                            </span></span>
                        </div>
                      </div>
                      <div class="n gf gg gh gi gj gk gl gm ab">
                        <div class="n o">
                          <div class="gn r ar"><a
                              href="//web.archive.org/web/20191222054305/https://medium.com/p/cbc1a5d5d3e9/share/twitter?source=post_actions_header---------------------------"
                              class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank"
                              rel="noopener"></a></div>
                          <div class="gn r ar"><a
                              href="//web.archive.org/web/20191222054305/https://medium.com/p/cbc1a5d5d3e9/share/facebook?source=post_actions_header---------------------------"
                              class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" target="_blank"
                              rel="noopener"></a></div>
                          <div class="go r ao">
                            <div>
                              <div class="cf" role="tooltip" aria-hidden="true"><a
                                  href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40ly.lee%2Fbuilding-a-rust-driver-for-pinetimes-touch-controller-cbc1a5d5d3e9&amp;source=post_actions_header--------------------------bookmark_sidebar-"
                                  class="at au av aw ax ay az ba bb bc bd be bf bg bh bi" rel="noopener"></a></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

<p>
  UPDATE: This code in this article has been archived in the <a href="https://github.com/lupyuen/pinetime-rust-mynewt/tree/pre-lvgl">pre-lvgl</a> branch of pinetime-rust-mynewt. 
  The pinetime-rust-mynewt firmware has been revamped to support <a href="https://lupyuen.github.io/pinetime-rust-mynewt/articles/watchface">Rust Watch Faces on LVGL</a>. 
  <a href="https://lupyuen.github.io/pinetime-rust-mynewt/articles/watchface">Check out the updates  </a>
</p>

                <p id="1b75" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Pretend you’re my IoT student. I
                  give you a <a class="at cg hd he hf hg" target="_blank" rel="noopener"
                    href="https://lupyuen.github.io/articles/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot">PineTime
                    Smart Watch</a> and challenge you to <em class="hh">“Make it work… Especially the touch
                    screen!”</em> The Touch Screen appears to be lacking some documentation. <em class="hh">What would
                    you do?</em></p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="6a39" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">PineTime Touch Screen = Touch
                  Panel + Display Panel</h1>
                <p id="e636" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">We carefully pry open the <a
                    href="https://wiki.pine64.org/index.php/PineTime"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">PineTime Smart Watch</a> with
                  tweezers (or forceps) and examine the Touch Screen. It looks like a single chunk of plastic… But it’s
                  actually two delicate pieces fused together: <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/PineTime%20Touch%20Panel.jpg"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">Touch
                      Panel</strong></a> and <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/PineTime%20LCD%20Panel.jpg"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">Display
                      Panel</strong></a>…</p>
                

                  <p><img src="https://lupyuen.github.io/images/legacy/i2.png" /></p>

                  <p><em>PineTime Touch Panel and Display Panel. From
                    <a href="http://files.pine64.org/doc/datasheet/pinetime/PineTime%20LCD%20Panel.jpg"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">http://files.pine64.org/doc/datasheet/pinetime/PineTime%20LCD%20Panel.jpg</a>
                    and <a
                      href="http://files.pine64.org/doc/datasheet/pinetime/PineTime%20Touch%20Panel.jpg"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">http://files.pine64.org/doc/datasheet/pinetime/PineTime%20Touch%20Panel.jpg</a>
                  </em></p>
                
                <p id="44ed" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The Touch Panel and Display Panel
                  are connected to the I2C and SPI connectors on the PineTime board…</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  
                    <p><img src="https://lupyuen.github.io/images/legacy/i3.png" /></p>

                    <p><em>Connectors for ST7789 Display Controller and
                      Hynitron CST816S Capacitive Touch Controller</em></p>
                  
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="65ef" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Last week we have <a
                    class="at cg hd he hf hg" target="_blank" rel="noopener"
                    href="https://lupyuen.github.io/articles/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot">programmed
                    the ST7789 Display Controller</a> (via SPI) to render colour text and graphics on the Display Panel.
                  This week we’ll look at the <a
                    href="https://wiki.pine64.org/images/5/51/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.en.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">Hynitron
                      CST816S Capacitive Touch Controller</strong></a> for PineTime’s Touch Panel…</p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="96cc" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Probing PineTime’s I2C Bus for
                  Touch Controller</h1>
                <p id="d9fa" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">The PineTime Touch Controller is
                  connected to the nRF52 Microcontroller via an <a
                    href="https://en.wikipedia.org/wiki/I%C2%B2C"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">I2C
                      Bus</strong></a>. That stands for <a
                    href="https://en.wikipedia.org/wiki/I%C2%B2C"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong
                      class="gr ii">Inter-Integrated Circuit</strong></a><strong class="gr ii"> </strong>and is
                  pronounced “<em class="hh">I-squared-C”. (I used to call it “I-two-C” until my IoT students corrected
                    me)</em></p>
                <p id="6665" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">News Flash!</em>
                  I2C works more like a <strong class="gr ii">Light Rail</strong> transit line than a Bus. It runs on
                  two rails (wires), shuttles tiny packets of passengers (data) between a Main Station (<strong
                    class="gr ii">Master Microcontroller</strong>) and Sub Stations (<strong class="gr ii">Slave
                    Devices</strong>)…</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  
                    <p><img src="https://lupyuen.github.io/images/legacy/i4.jpeg" /></p>

                    <p><em>Light Rail Transit Line</em></p>
                  
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="dde8" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">In Light Rail, the train is sent
                  from the Main Station to each Sub Station to drop off passengers. And we expect the train to pick up
                  passengers from each Sub Station. A Sub Station with drop-offs but no pick-ups will be so spooky… <em
                    class="hh">like a Ghost Station!</em></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  
                    <p><img src="https://lupyuen.github.io/images/legacy/i5.jpeg" /></p>

                    <p><em>I2C (Inter-Integrated Circuit) Bus on
                      PineTime</em></p>
                  
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="ebfe" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Thankfully there
                    are no Ghost Stations in I2C…</em> When the Microcontroller sends a packet to a Slave Device at a
                  particular address, the <strong class="gr ii">Slave Device must respond</strong> with another packet.
                  This called <a
                    href="https://mynewt.apache.org/latest/os/modules/hal/hal_i2c/hal_i2c.html#c.hal_i2c_master_probe"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">I2C
                      Probing</strong></a> and the Rust code on PineTime looks like this…</p>
                

                  <p><script src="https://gist.github.com/lupyuen/471b5f467567e6031df9de8c308161ef.js"></script></p>

                  <p><em>Probing the I2C Bus on PineTime to discover
                    I2C devices. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="92bb" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">There are only <strong
                    class="gr ii">128 possible I2C Addresses</strong> (0 to 127) so it’s feasible to identify all I2C
                  Slave Devices by probing each address. <em class="hh">(</em><a
                    href="https://learn.adafruit.com/i2c-addresses/the-list"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">Here’s a list of
                      I2C Addresses for popular devices</em></a><em class="hh">)</em></p>
                <p id="e09b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Running the above code on
                  PineTime we find <strong class="gr ii">two devices</strong> on our I2C Bus, at I2C Addresses <code
                    class="dm jg jh ji jj b">0x18</code> and <code class="dm jg jh ji jj b">0x44</code>. That’s the <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/BST-BMA421-FL000.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong
                      class="gr ii">Accelerometer</strong></a> and <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/HRS3300%20Heart%20Rate%20Sensor.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">Heart Rate
                      Sensor</strong></a><strong class="gr ii">.</strong> <em class="hh">(I verified against the
                    docs)</em></p>
                <p id="29dc" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">But where’s the
                    Touch Controller? Do Ghost Stations really exist on I2C?</em></p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="5449" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">PineTime Touch Controller
                  responds to Special Events</h1>
                <p id="215d" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">Back to our Light Rail analogy…
                  Suppose we have a Sub Station that serves an <em class="hh">Amusement Park</em>. The Sub Station
                  operates on <em class="hh">special occasions</em> like weekends and holidays. Most of the time it
                  would appear as a Ghost Station… <em class="hh">Coming to life only on special occasions!</em></p>
                <p id="72df" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">What is this
                    “Special Event&quot; that brings our Touch Controller to life?</em></p>
                <p id="afb4" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Maybe it’s low on
                    power?</em> This power problem happens often with <a class="at cg hd he hf hg" target="_blank"
                    rel="noopener"
                    href="https://lupyuen.github.io/articles/connect-stm32-blue-pill-to-nb-iot-with-quectel-bc95-g-and-apache-mynewt">wireless
                    gadgets like NB-IoT</a>. We connect the 5 Volt power from the ST-Link USB dongle and… <em
                    class="hh">Nothing changes! (Though the PineTime Battery gets properly charged now… Nice!)</em></p>
              </div>
            </div>
            <div class="cz ak">
              
                <p><img src="https://lupyuen.github.io/images/legacy/i6.jpeg" /></p>

                <p><em>Connecting the 5V Charging Pad on PineTime to
                  the 5V Pin of ST-Link with a folded loop of Single Core Wire (22 AWG)</em></p>
              
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="e80b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">(Don’t forget the
                    “Only One Power Source” OOPS Rule… Our computer’s USB port supplies both 3.3 Volt and 5 Volt power
                    sources… Never use two different power sources… OOPS!)</em></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  
                    <p><img src="https://lupyuen.github.io/images/legacy/i7.png" /></p>

                    <p><em>Touch Controller State Transition Diagram
                      from <a
                        href="http://files.pine64.org/doc/datasheet/pinetime/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.pdf"
                        class="at cg hd he hf hg" target="_blank"
                        rel="noopener nofollow">http://files.pine64.org/doc/datasheet/pinetime/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.pdf</a>.
                      English Translation: <a
                        href="https://wiki.pine64.org/images/5/51/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.en.pdf"
                        class="at cg hd he hf hg" target="_blank"
                        rel="noopener nofollow">https://wiki.pine64.org/images/5/51/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.en.pdf</a>
                    </em></p>
                  
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="a238" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">We stare hard at this State
                  Transition Diagram from the <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">Touch Controller doc</a>. (The <a
                    href="https://wiki.pine64.org/images/5/51/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.en.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">English Translation</a> looked
                  alien so we’re using the <a
                    href="http://files.pine64.org/doc/datasheet/pinetime/CST816S%E6%95%B0%E6%8D%AE%E6%89%8B%E5%86%8CV1.1.pdf"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">original Chinese version</a> with
                  my translation) <em class="hh">What is it trying to tell us?</em></p>
                <p id="f4d3" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">It says that the
                    Touch Controller can be woken from the Standby Mode… By Touch!</em></p>
                <p id="b014" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">We tap the screen… Sure enough
                  our <em class="hh">Ghost Station comes to life!</em> Our <strong class="gr ii">Touch Controller needs
                    a little tap</strong> <em class="hh">(the “Special Event”)</em> to <strong class="gr ii">wake it up
                    and respond</strong> to I2C packets. <em class="hh">Mystery solved!</em></p>
                <p id="6215" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">With screen tapping and I2C
                  probing, we finally locate PineTime’s Touch Controller… <strong class="gr ii">At I2C Address
                  </strong><code class="dm jg jh ji jj b"><strong class="gr ii">0x15</strong></code></p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="9afc" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">I2C Streaming with PineTime
                  Touch Controller</h1>
                <p id="4e98" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">To discover which parts of the
                  screen are touched (up to 10 points), we need to read <strong class="gr ii">63 bytes</strong> from the
                  PineTime Touch Controller… <em class="hh">That’s 63 consecutive I2C Registers, 1 byte per
                    register!</em></p>
                <p id="f831" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">There’s an efficient way to read
                  63 consecutive I2C Registers from the PineTime Touch Controller. Some people call it Bulk Reading but
                  let’s call it <strong class="gr ii">I2C Streaming</strong>.</p>
                <p id="7978" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Ever used a Rubber
                    Hose to siphon petrol / gasoline / fish tank water?</em> We suck a bit of air out of the Rubber
                  Hose, maybe we’ll taste a bit of the petrol / gasoline / fish tank water <em class="hh">(whoa that’s
                    nasty)</em>, and the liquid comes streaming out. <em class="hh">(Yes you can remove the hose from
                    your mouth now!)</em></p>
                <p id="f269" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The liquid keeps streaming until
                  you stop it. I2C Streaming works just like that… We instruct the Touch Controller (via its I2C Address
                  <code class="dm jg jh ji jj b">0x15</code>) to send us the value of I2C Register <code
                    class="dm jg jh ji jj b">#0</code>. The Touch Controller will stream a list of consecutive I2C
                  Register values (Register <code class="dm jg jh ji jj b">#0</code>, <code
                    class="dm jg jh ji jj b">#1</code>, <code class="dm jg jh ji jj b">#2</code>, …) Until we receive 63
                  values and we tell the Touch Controller <em class="hh">“Stop!!!”</em></p>
                <p id="2ec1" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">I2C Streaming runs in five steps
                  like this…</p>
              </div>
            </div>
            <div class="cz ak">
              
                <p><img src="https://lupyuen.github.io/images/legacy/i8.png" /></p>

                <p><em>Steps to stream I2C Registers #0 to #62 from the
                  I2C Touch Controller at I2C Address 0x15</em></p>
              
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="f420" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr ii">Steps 1
                    through 5</strong> are explained in the Rust code below that reads a range of I2C Registers
                  (Registers <code class="dm jg jh ji jj b">#0</code> to <code class="dm jg jh ji jj b">#62</code>,
                  total 63 Registers) from the Touch Controller (at I2C Address <code
                    class="dm jg jh ji jj b">0x15</code>)</p>
                

                  <p><script src="https://gist.github.com/lupyuen/5640343e09de8d68d297bfe6560bb8eb.js"></script></p>

                  <p><em>Rust code to read a range of I2C Registers
                    from an I2C Device on PineTime. The steps in the comments refer to the steps in the diagram above.
                    From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="26b9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Yep the code looks alarming with
                  the <code class="dm jg jh ji jj b">unsafe</code> blocks (because we are calling C APIs from Rust).
                  Eventually we should implement the I2C Interface for Rust Embedded HAL… And the <code
                    class="dm jg jh ji jj b">unsafe</code> blocks will be gone forever.</p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="73fc" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Convert PineTime Touch Data
                </h1>
                <p id="cf3b" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">The PineTime Touch Controller
                  generates <strong class="gr ii">63 bytes of raw touch data</strong> on every touch. <em
                    class="hh">(</em><a
                    href="https://github.com/lupyuen/hynitron_i2c_cst0xxse/blob/master/cst0xx_core.c#L407-L466"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">According to the
                      reference code here</em></a><em class="hh">)</em> When converted, these 63 bytes produce <strong
                    class="gr ii">10 points of touch information</strong>. Each point of touch information contains…</p>
                <p id="2d9d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">1️⃣ <strong class="gr ii">X
                    (Horizontal) and Y (Vertical) Coordinates</strong> of the touched point. <code
                    class="dm jg jh ji jj b">(0, 0)</code> represents top left, <code
                    class="dm jg jh ji jj b">(239, 239)</code> represents bottom right.</p>
                <p id="5e7c" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">2️⃣ <strong
                    class="gr ii">Action</strong>: Whether the point was just touched, just untouched or kept in contact
                </p>
                <p id="88ef" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">3️⃣ <strong
                    class="gr ii">Finger</strong>: A number that identifies the finger that touched the point</p>
                <p id="dcf1" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">4️⃣ <strong
                    class="gr ii">Pressure</strong>: How hard the point was touched</p>
                <p id="f4b5" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">5️⃣ <strong
                    class="gr ii">Area</strong>: Size of the touched area</p>
                

                  <p><script src="https://gist.github.com/lupyuen/b7ab0cd0d205672911f2000ea183d005.js"></script></p>

                  <p><em>63 bytes of raw touch data converted to 10
                    points of touch information. This is the Rust representation of the 10 touch points. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="e3db" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">That’s a lot of
                    information for each point touched… Why do we need so much information? Why the
                    finger-pointing?</em></p>
                <p id="35b7" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Think of the classic 2010 iPad
                  game <a href="https://en.wikipedia.org/wiki/Fruit_Ninja"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">Fruit
                      Ninja</em></a>… The game tracks the swiping motion of each finger to figure out which fruits (and
                  bombs) you’re slashing. So the tracking of each finger is important for swiping-based apps. <em
                    class="hh">(Like </em><a
                    href="https://en.wikipedia.org/wiki/Tinder_(app)"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">Tinder</em></a><em
                    class="hh">)</em></p>
                <p id="c40f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The Touch Controller doesn’t
                  really know whether you touched the screen with your left forefinger or your right thumb <em
                    class="hh">(or your nose)</em>… It just assigns a number to the finger <em class="hh">(or
                    appendage)</em> that’s swiping the screen. The Touch Action (touched / untouched / in contact) is
                  necessary to determine whether this is the start, middle or end of a swipe.</p>
                <p id="aeef" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Based on the <a
                    href="https://github.com/lupyuen/hynitron_i2c_cst0xxse/blob/master/cst0xx_core.c#L407-L466"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">reference code</a>, we derived the
                  following Rust function for reading and converting the 63 bytes of raw touch data into touch points.
                  Note that only the <em class="hh">first 5 touch points</em> out of 10 are converted. <em
                    class="hh">(Probably because it’s not meaningful to track 10 fingers on a tiny watch screen)</em>
                </p>
                

                  <p><script src="https://gist.github.com/lupyuen/5640343e09de8d68d297bfe6560bb8eb.js"></script></p>

                  <p><em>Rust code to convert raw touch data to touch
                    point information. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="bbd0" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Display PineTime Touch Data
                </h1>
                <p id="dbd6" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">Now that we have the converted
                  touch data, let’s display the data on the screen to verify that we have converted the data correctly.
                  Here’s the Rust code that takes coordinates <code class="dm jg jh ji jj b">(X, Y)</code> and displays
                  them as <code class="dm jg jh ji jj b">X = …, Y = …</code> on the PineTime screen…</p>
                

                  <p><script src="https://gist.github.com/lupyuen/b7ab0cd0d205672911f2000ea183d005.js"></script></p>

                  <p><em>Rust code to display the touched coordinates
                    on the screen. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/display.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/display.rs</a>
                  </em></p>
                
                <p id="90c0" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Notice that we passed a special
                  <code
                    class="dm jg jh ji jj b"><a href="https://docs.rs/arrayvec/0.3.25/arrayvec/struct.ArrayString.html" class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">arrayvec::ArrayString</a></code>
                  type to the <code class="dm jg jh ji jj b">write!()</code> macro for storing the formatted text.
                  That’s because the <code class="dm jg jh ji jj b">write!()</code> macro normally accepts a <code
                    class="dm jg jh ji jj b">String</code> type for storing formatted text… But <code
                    class="dm jg jh ji jj b">String</code> relies on Dynamic Heap Memory which we don’t support in our
                  Rust Application.</p>
                <p id="7379" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Why no Heap in our
                    application?</em> For Embedded Applications it’s a good practice to budget our memory requirements
                  in advance and allocate our variables statically. Yes that means we have to do more planning while
                  designing our programs… But we prevent problems like running out of heap memory (and heap
                  fragmentation).</p>
                <p id="1b6a" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">In the above code we have
                  budgeted 20 bytes in our fixed-size <code class="dm jg jh ji jj b">arrayvec::ArrayString</code> buffer
                  for storing each formatted text string.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  
                    <p><img src="https://lupyuen.github.io/images/legacy/i9.jpeg" /></p>

                    <p><em>Displaying touched coordinates on PineTime
                      screen</em></p>
                  
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <p id="0d28" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Mr Diego Barrios Romero has an
                  excellent suggestion for handling Rust strings without heaps…</p>
                <blockquote class="jq jr js">
                  <p id="5fab" class="gp gq ec hh gr b gs gt gu gv gw gx gy gz ha hb hc">For the strings you can also
                    use the <code class="dm jg jh ji jj b">String</code> type from the <code
                      class="dm jg jh ji jj b"><a href="https://crates.io/crates/heapless" class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">heapless</a></code>
                    crate like this<br /><code
                      class="dm jg jh ji jj b">let mut buffer: <br/> heapless::String&lt; heapless::consts::U64 &gt; <br/> = heapless::String::new();</code>
                  </p>
                </blockquote>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="e8fe" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">Transform PineTime Touch
                  Interrupt to Mynewt Event Callback</h1>
                <p id="0882" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">We have our PineTime Touch
                  Controller all figured out… Reading the I2C Registers, converting the touch data and displaying the
                  touch data. <em class="hh">But something important is still missing…</em></p>
                
                  <p><img src="https://lupyuen.github.io/images/legacy/i10.png" /></p>

                  <p><em>Reading, converting and displaying touch data
                  </em></p>
                
                <p id="e853" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Remember the Ghost
                    Station?</em> We can’t read the I2C Registers on the Touch Controller unless the screen has been
                  tapped… <em class="hh">So how will we know when to read the registers?</em></p>
                
                  <p><img src="https://lupyuen.github.io/images/legacy/i11.png" /></p>

                  <p><em>Need to handle the Touch Interrupt and get an
                    Event Callback first</em></p>
                
                <p id="6502" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Fortunately the Touch Controller
                  generates a <strong class="gr ii">Touch Interrupt</strong> every time the screen is tapped. So let’s
                  hook on to the Touch Interrupt and do the touch processing there!</p>
                

                  <p><script src="https://gist.github.com/lupyuen/8d54c8d201a111d6d596de428e538c62.js"></script></p>

                  <p><em>Assigning an Interrupt Handler for Touch
                    Interrupt. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="f298" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The Touch Interrupt is raised via
                  a normal GPIO Pin (<code class="dm jg jh ji jj b">P0.28</code>). In the Rust code above, we ask Mynewt
                  OS to watch out for the Touch Interrupt on the GPIO Pin, and call <code
                    class="dm jg jh ji jj b">touch_interrupt_handler()</code> when the GPIO Pin switches from High to
                  Low. <em class="hh">(That’s when the screen is tapped)</em></p>
                

                  <p><script src="https://gist.github.com/lupyuen/40ff076926597a5ba16a6ba68ec8832d.js"></script></p>

                  <p><em>Touch interrupt handler that’s called upon
                    touch. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="2280" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code
                    class="dm jg jh ji jj b">touch_interrupt_handler()</code> is an <strong class="gr ii">Interrupt
                    Handler Function</strong>. Note that this Rust function is declared <code
                    class="dm jg jh ji jj b">extern “C”</code> because it will be called by Mynewt OS whenever the Touch
                  Interrupt occurs. So it appears to Mynewt OS like a regular C function.</p>
                <p id="788d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><code
                    class="dm jg jh ji jj b">touch_interrupt_handler()</code> looks… <em class="hh">underwhelming</em>.
                  <em class="hh">Where’s all the touch data processing we covered earlier?</em></p>
                <p id="1a0f" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">That’s because Interrupt Handlers
                  are not meant for doing any kind of data processing! Mynewt OS has gone out of its usual routine, just
                  to call our Interrupt Handler because somebody touched the screen. Mynewt OS could have been <strong
                    class="gr ii">doing something very important</strong> when the interrupt occurred!</p>
                <p id="b838" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><em class="hh">Would be so rude
                    of us to snatch Mynewt OS away from some important task… Just to swipe some fruits / bombs / dating
                    profiles!</em></p>
                <p id="6eaf" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">So let’s be polite to Mynewt OS
                  and take up as little time as possible. We’ll defer the swiping of the fruit / bomb / dating profile…
                  By adding a <strong class="gr ii">Mynewt Event</strong> to <strong class="gr ii">Mynewt’s </strong><a
                    href="https://mynewt.apache.org/latest/os/core_os/event_queue/event_queue.html"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><strong class="gr ii">Event
                      Queue</strong></a>.</p>
                

                  <p><script src="https://gist.github.com/lupyuen/3a438f3e2e399c5c4679af70fc63cf69.js"></script></p>

                  <p><em>Event callback for handling touch events. From
                    <a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs"
                      class="at cg hd he hf hg" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/pinetime/rust/app/src/touch_sensor.rs</a>
                  </em></p>
                
                <p id="4975" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Here’s the Rust code that will
                  eventually be triggered via the Mynewt Event, after Mynewt OS has completed the important tasks. We
                  read the touch data (via I2C Streaming) and display the first detected touch point.</p>
                <p id="0598" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The complete flow from Touch
                  Interrupt to Touch Data Display looks like this. The Rust Driver for PineTime Touch Controller is
                  incomplete because we haven’t implemented <strong class="gr ii">Hit Testing</strong> to detect the
                  graphic or text on the screen that’s tapped… So Hit Testing is coming next! <em class="hh">(And if you
                    wish to help out, drop me a note!)</em></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="iq ir is it iu iv ag iw ah ix aj ak">
                  

                    <p><a href="https://youtu.be/4_93mUkK--U">[Watch demo video on YouTube]</a></p>

                    <p><em>PineTime Touch Controller fully functioning
                      with Touch Interrupts</em></p>
                  
                </div>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="c9ac" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">What’s Next?</h1>
                <p id="4179" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">Here are the other articles in
                  the PineTime series…</p>
                <div class="jy jz ka kb kc kd"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot">
                    <section class="kg cl cm ak ce n ar kh ki kj kk kl km kn ko kp kq kr ks kt ku kv">
                      <div class="kw n co p kx ky">
                        <h2 class="bj ht kz bl ec">
                          <div class="di ke fm fn kf fp">Sneak Peek of PineTime Smart Watch… And why it’s perfect for
                            teaching IoT</div>
                        </h2>
                      </div>
                      <div class="lc r">
                        <div class="ld r le lf lg lc lh li lj"></div>
                      </div>
                    </section>
                  </a></div>
                <div class="jy jz ka kb kc kd"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/porting-druid-rust-widgets-to-pinetime-smart-watch">
                    <section class="kg cl cm ak ce n ar kh ki kj kk kl km kn ko kp kq kr ks kt ku kv">
                      <div class="kw n co p kx ky">
                        <h2 class="bj ht kz bl ec">
                          <div class="di ke fm fn kf fp">Porting [druid] Rust Widgets to PineTime Smart Watch</div>
                        </h2>
                      </div>
                      <div class="lc r">
                        <div class="lk r le lf lg lc lh li lj"></div>
                      </div>
                    </section>
                  </a></div>
                <p id="52c7" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Last week I declared that <a
                    class="at cg hd he hf hg" target="_blank" rel="noopener"
                    href="https://lupyuen.github.io/articles/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot"><strong
                      class="gr ii">PineTime is perfect for teaching IoT</strong></a>… Today I’m walking the talk by
                  applying PineTime to explain how a modern touchscreen works!</p>
                <p id="97e8" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">I built the Rust driver <strong
                    class="gr ii">iteratively</strong> (pretty much in the same sequence we see in this article)… <em
                    class="hh">I really love the way Rust and Mynewt OS on PineTime make Embedded Experiments so fun and
                    easy to execute!</em></p>
                <p id="90e9" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">As we have seen today, building
                  the right IoT Software to run on today’s IoT Hardware can be challenging because of <strong
                    class="gr ii">language issues</strong>. If you can read Chinese like me… <strong class="gr ii">Hang
                    on to this precious skill!</strong> <em class="hh">(Try watching </em><a
                    href="https://en.wikipedia.org/wiki/Story_of_Yanxi_Palace"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">延禧攻略</em></a><em
                    class="hh"> or the </em><a
                    href="https://video.toggle.sg/en/8-news-tonight-5180828"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow"><em class="hh">Mandarin
                      news</em></a><em class="hh">)</em></p>
                <p id="582b" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">I bet at this very moment, a
                  non-native English reader is trying to read this English article…<em class="hh"> Struggling to
                    understand “Ghost Station”, “dating profile”, “fish tank water” and their relevance to Touch
                    Controllers.</em></p>
                <p id="c330" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr ii">IoT
                    Education across all languages</strong> is needed now, more than ever. Here’s what I’m doing about
                  it…</p>
                <p id="819c" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc"><strong class="gr ii">I hereby
                    waive all copyright on my articles. You may reproduce my articles in any language, without asking
                    for my permission.</strong></p>
                <p id="8610" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">Although a few of my articles
                  have been translated into <a
                    href="https://www.kidscoding8.com/98097.html"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">Chinese</a> and <a
                    href="https://qiita.com/ghibi/items/81fed94d9fc3eb81df62"
                    class="at cg hd he hf hg" target="_blank" rel="noopener nofollow">Japanese</a>… We can do better.
                  <em class="hh">Let’s share our IoT skills worldwide! </em>😀</p>
              </div>
            </div>
          </section>
          <hr class="hi dy hj hk hl dv hm hn ho hp hq" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah dz aj ak">
                <h1 id="0e98" class="hr hs ec bk bj ht ee hu eg hv hw hx hy hz ia ib ic">References</h1>
                <p id="36a6" class="gp gq ec bk gr b gs id gu ie gw if gy ig ha ih hc">Please refer to the <em
                    class="hh">“References”</em> section at the end of the previous article <em class="hh">“</em><a
                    class="at cg hd he hf hg" target="_blank" rel="noopener"
                    href="https://lupyuen.github.io/articles/sneak-peek-of-pinetime-smart-watch-and-why-its-perfect-for-teaching-iot"><em
                      class="hh">Sneak Peek of PineTime Smart Watch… And why it’s perfect for teaching IoT</em></a><em
                    class="hh">”</em></p>
                <p id="408d" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">To run the code on a PineTime
                  Smart Watch, follow the instructions in the section <em class="hh">“Programming the PineTime Smart
                    Watch”</em> of the above article.</p>
                <p id="f62c" class="gp gq ec bk gr b gs gt gu gv gw gx gy gz ha hb hc">The updated code may be found in
                  the <code class="dm jg jh ji jj b">pinetime</code> branch of this repository, which is the same branch
                  used in the previous article…</p>
                <div class="jy jz ka kb kc kd"><a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/tree/pinetime"
                    rel="noopener nofollow">
                    <section class="kg cl cm ak ce n ar kh ki kj kk kl km kn ko kp kq kr ks kt ku kv">
                      <div class="kw n co p kx ky">
                        <h2 class="bj ht kz bl ec">
                          <div class="di ke fm fn kf fp">lupyuen/stm32bluepill-mynewt-sensor</div>
                        </h2>
                      </div>
                      <div class="lc r">
                        <div class="ll r le lf lg lc lh li lj"></div>
                      </div>
                    </section>
                  </a></div>
              </div>
            </div>
          </section>
        </div>
      </article>
    </div>
  </div>
</body>

</html>
<!--
     FILE ARCHIVED ON 05:43:05 Dec 22, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:23:45 Feb 20, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  exclusion.robots: 0.35
  captures_list: 102.325
  LoadShardBlock: 67.773 (3)
  RedisCDXSource: 0.845
  PetaboxLoader3.datanode: 90.834 (4)
  esindex: 0.015
  PetaboxLoader3.resolve: 19.38
  exclusion.robots.policy: 0.334
  CDXLines.iter: 29.58 (3)
  load_resource: 67.221
-->