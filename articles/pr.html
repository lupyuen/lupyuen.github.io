<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>Preparing a Pull Request for Apache NuttX RTOS</title>

    
    <!-- Begin scripts/articles/*-header.html: Article Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<meta property="og:title" 
    content="Preparing a Pull Request for Apache NuttX RTOS" 
    data-rh="true">
<meta property="og:description" 
    content="Here are the steps to prepare a Pull Request for Apache NuttX RTOS"
    data-rh="true">
<meta name="description" 
    content="Here are the steps to prepare a Pull Request for Apache NuttX RTOS">
<meta property="og:image" 
    content="https://lupyuen.github.io/images/pr-title.jpg">
<meta property="og:type" 
    content="article" data-rh="true">
<!-- End scripts/articles/*-header.html -->
<!-- Begin scripts/rustdoc-header.html: Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<link rel="alternate" type="application/rss+xml" title="RSS Feed for lupyuen" href="/rss.xml" />
<link rel="stylesheet" type="text/css" href="../normalize.css">
<link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle">
<link rel="stylesheet" type="text/css" href="../dark.css">
<link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle">
<link rel="stylesheet" type="text/css" href="../prism.css">
<script src="../storage.js"></script><noscript>
<link rel="stylesheet" href="../noscript.css"></noscript>
<link rel="shortcut icon" href="../favicon.ico">
<style type="text/css">
    #crate-search {
        background-image: url("../down-arrow.svg");
    }
</style>
<!-- End scripts/rustdoc-header.html -->


</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    
    <!-- Begin scripts/rustdoc-before.html: Pre-HTML for Custom Markdown files processed by rustdoc, like chip8.md -->

    <!-- Begin Theme Picker -->
    <div class="theme-picker" style="left: 0"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg"
        width="18" alt="Pick another theme!"></button>
        <div id="theme-choices"></div>
    </div>
    <!-- Theme Picker -->

    <!-- End scripts/rustdoc-before.html -->
    

    <h1 class="title">Preparing a Pull Request for Apache NuttX RTOS</h1>
    <nav id="TOC"><ul>
<li><a href="#nuttx-repositories">1 NuttX Repositories</a><ul></ul></li>
<li><a href="#build-and-test">2 Build and Test</a><ul>
<li><a href="#regression-test">2.1 Regression Test</a><ul></ul></li>
<li><a href="#documentation">2.2 Documentation</a><ul></ul></li></ul></li>
<li><a href="#check-coding-style">3 Check Coding Style</a><ul></ul></li>
<li><a href="#write-the-pull-request">4 Write the Pull Request</a><ul>
<li><a href="#title">4.1 Title</a><ul></ul></li>
<li><a href="#summary">4.2 Summary</a><ul></ul></li>
<li><a href="#impact">4.3 Impact</a><ul></ul></li>
<li><a href="#testing">4.4 Testing</a><ul></ul></li></ul></li>
<li><a href="#squash-the-commits">5 Squash the Commits</a><ul></ul></li>
<li><a href="#meditate">6 Meditate</a><ul></ul></li>
<li><a href="#submit-the-pull-request">7 Submit the Pull Request</a><ul></ul></li>
<li><a href="#update-our-repositories">8 Update Our Repositories</a><ul></ul></li>
<li><a href="#whats-next">9 Whatâ€™s Next</a><ul></ul></li>
<li><a href="#notes">10 Notes</a><ul></ul></li>
<li><a href="#appendix-validate-nuttx-release">11 Appendix: Validate NuttX Release</a><ul></ul></li></ul></nav><p>ğŸ“ <em>28 Nov 2022</em></p>
<p><img src="https://lupyuen.github.io/images/pr-title.jpg" alt="Typical Pull Request for Apache NuttX RTOS" /></p>
<p>This article explains how I prepared my Pull Requests for submission to <a href="https://nuttx.apache.org/docs/latest/index.html"><strong>Apache NuttX RTOS</strong></a>. So if weâ€™re contributing code to NuttX, just follow these steps and things will (probably) go Hunky Dory!</p>
<p>(Like the fish)</p>
<p>Before we begin, please swim over to the official <strong>Development Workflow</strong> for NuttXâ€¦</p>
<ul>
<li><a href="https://nuttx.apache.org/docs/latest/contributing/workflow.html"><strong>â€œNuttX Development Workflowâ€</strong></a></li>
</ul>
<p>Ready? Letâ€™s dive in! (Like the fish)</p>
<p><img src="https://lupyuen.github.io/images/pr-fork.png" alt="Create Fork" /></p>
<h1 id="nuttx-repositories"><a class="doc-anchor" href="#nuttx-repositories">Â§</a>1 NuttX Repositories</h1>
<p>We begin by <strong>creating our forks</strong> for the <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> repositoriesâ€¦</p>
<ol>
<li>
<p>Browse to <strong>NuttX Repository</strong>â€¦</p>
<p><a href="https://github.com/apache/nuttx"><strong>github.com/apache/nuttx</strong></a></p>
<p>Click â€œ<strong>Fork</strong>â€ to create our fork. (Pic above)</p>
<p>Click â€œ<strong>Actions</strong>â€ and enable workflowsâ€¦</p>
<p><img src="https://lupyuen.github.io/images/pr-actions.png" alt="Enable Workflows" /></p>
<p>(This will check that our code compiles OK at every commit)</p>
</li>
<li>
<p>Do the same for the <strong>NuttX Apps Repository</strong>â€¦</p>
<p><a href="https://github.com/apache/nuttx-apps"><strong>github.com/apache/nuttx-apps</strong></a></p>
<p>Click â€œ<strong>Fork</strong>â€ to create our fork.</p>
<p>Click â€œ<strong>Actions</strong>â€ and enable workflows.</p>
</li>
<li>
<p>As a principle, letâ€™s keep our <strong><code>master</code></strong> branch <strong>always in sync</strong> with the NuttX Mainline <strong><code>master</code></strong> branch.</p>
<p>(This seems cleaner for <a href="https://lupyuen.github.io/articles/pr#update-our-repositories"><strong>syncing upstream updates</strong></a> into our repo)</p>
<p>Letâ€™s <strong>create a branch</strong> to make our changesâ€¦</p>
</li>
<li>
<p>In our NuttX Repository, click <strong><code>master</code></strong>.</p>
<p>Enter the name of our new branch.</p>
<p>Click â€œ<strong>Create Branch</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-branch.png" alt="Create Branch" /></p>
<p><a href="https://github.com/lupyuen2/wip-nuttx/tree/gic">(I named my branch <strong><code>gic</code></strong> for Generic Interrupt Controller)</a></p>
</li>
<li>
<p>Do the same for our <strong>NuttX Apps Repository</strong></p>
<p>(Because we should sync <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> too)</p>
</li>
<li>
<p>Download the new branches of our <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> repositoriesâ€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>## Download the &quot;gic&quot; branch of &quot;lupyuen2/wip-nuttx&quot;
## TODO: Change the branch name and repo URLs
mkdir nuttx
cd nuttx
git clone \
  --branch gic \
  https://github.com/lupyuen2/wip-nuttx \
  nuttx
git clone \
  --branch gic \
  https://github.com/lupyuen2/wip-nuttx-apps \
  apps
</code></pre></div></li>
</ol>
<h1 id="build-and-test"><a class="doc-anchor" href="#build-and-test">Â§</a>2 Build and Test</h1>
<p>Weâ€™re ready to code!</p>
<ol>
<li>
<p>Consider breaking our Pull Request into <strong>Smaller Pull Requests</strong>.</p>
<p>This Pull Request implements <strong>One Single Feature</strong> (Generic Interrupt Controller)â€¦</p>
<p><a href="https://github.com/apache/nuttx/pull/7630"><strong>â€œarch/arm64: Add support for Generic Interrupt Controller Version 2â€</strong></a></p>
<p>Thatâ€™s called by another Pull Requestâ€¦</p>
<p><a href="https://github.com/apache/nuttx/pull/7692"><strong>â€œarch/arm64: Add support for PINE64 PinePhoneâ€</strong></a></p>
<p>Adding a NuttX Arch (SoC) and Board might need 3 Pull Requests (or more)â€¦</p>
<p><a href="https://lupyuen.github.io/articles/release#add-the-nuttx-arch-and-board"><strong>â€œAdd the NuttX Arch and Boardâ€</strong></a></p>
</li>
<li>
<p><strong>Modify the code</strong> in <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> to implement our awesome new feature.</p>
</li>
<li>
<p><strong>Build and test</strong> the modified code.</p>
<p><a href="https://gist.github.com/lupyuen/5e2fba642a33bf64d3378df3795042d7">(I configured <code>F1</code> in VSCode to run this <strong>Build Script</strong>)</a></p>
</li>
<li>
<p>Capture the <strong>Output Log</strong> and save it as a <a href="https://gist.github.com/lupyuen/7537da777d728a22ab379b1ef234a2d1"><strong>GitHub Gist</strong></a>â€¦</p>
<p><a href="https://gist.github.com/lupyuen/7537da777d728a22ab379b1ef234a2d1"><strong>â€œNuttX QEMU Log for Generic Interrupt Controllerâ€</strong></a></p>
<p>Weâ€™ll add this to our Pull Request. <strong>Test Logs are super helpful</strong> for NuttX Maintainers!</p>
<p>(Because we canâ€™t tell which way the train wentâ€¦ Unless we have the Test Logs!)</p>
</li>
<li>
<p><strong>Commit the modified code</strong> to our repositories.</p>
<p>Sometimes the <strong>GitHub Actions Workflow</strong> will fail with a strange error (like below). Just re-run the failed jobs. <a href="https://lupyuen.github.io/images/pr-rerun.png">(Like this)</a></p>
<div class="example-wrap"><pre class="language-text"><code>Error response from daemon:
login attempt to https://ghcr.io/v2/
failed with status: 503 Service Unavailable&quot;
</code></pre></div></li>
</ol>
<h2 id="regression-test"><a class="doc-anchor" href="#regression-test">Â§</a>2.1 Regression Test</h2>
<p><em>Will our modified code break other parts of NuttX?</em></p>
<p>Thatâ€™s why itâ€™s good to run a <a href="https://en.wikipedia.org/wiki/Regression_testing"><strong>Regression Test</strong></a> (if feasible) to be sure that other parts of NuttX arenâ€™t affected by our modified code.</p>
<p>For our Pull Requestâ€¦</p>
<ul>
<li><a href="https://github.com/apache/nuttx/pull/7630"><strong>â€œarch/arm64: Add support for Generic Interrupt Controller Version 2â€</strong></a></li>
</ul>
<p>We tested with <a href="https://www.qemu.org/docs/master/system/target-arm.html"><strong>QEMU Emulator</strong></a> our <strong>new implementation</strong> of Generic Interrupt Controller v2â€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>tools/configure.sh qemu-armv8a:nsh_gicv2 ; make ; qemu-system-aarch64 ...
</code></pre></div>
<p><a href="https://gist.github.com/lupyuen/7537da777d728a22ab379b1ef234a2d1">(See the NuttX QEMU Log)</a></p>
<p>And for Regression Testing we tested the <strong>existing implementation</strong> of Generic Interrupt Controller v3â€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>tools/configure.sh qemu-armv8a:nsh ; make ; qemu-system-aarch64 ...
</code></pre></div>
<p><a href="https://gist.github.com/lupyuen/dec66bc348092a998772b32993e5ed65">(See the NuttX QEMU Log)</a></p>
<p>Remember to capture the <strong>Output Log</strong>, weâ€™ll add it to our Pull Request.</p>
<p>(Yeah it will be hard to run a Regression Test if it requires hardware that we donâ€™t have)</p>
<h2 id="documentation"><a class="doc-anchor" href="#documentation">Â§</a>2.2 Documentation</h2>
<p>Please update the <strong>Documentation</strong>. The Documentation might be in a <strong>Text File</strong>â€¦</p>
<ul>
<li><a href="https://github.com/apache/nuttx/blob/master/boards/arm64/qemu/qemu-armv8a/README.txt"><strong>nuttx/â€¦/README.txt</strong></a></li>
</ul>
<p>Or in the <strong>Official NuttX Docs</strong>â€¦</p>
<ul>
<li><a href="https://github.com/apache/nuttx/blob/master/Documentation/platforms/arm/a64/boards/pinephone/index.rst"><strong>nuttx/Documentation/â€¦/index.rst</strong></a></li>
</ul>
<p>To update the Official NuttX Docs, follow the instructions hereâ€¦</p>
<ul>
<li>
<p><a href="https://nuttx.apache.org/docs/latest/contributing/documentation.html"><strong>â€œNuttX Documentationâ€</strong></a></p>
<p><a href="https://gist.github.com/lupyuen/c061ac688f430ef11a1c60e0b284a1fe">(See the Log)</a></p>
</li>
</ul>
<p><strong>For macOS:</strong> We may need to use â€œ<strong>brew install pipenv</strong>â€ instead of â€œ<strong>pip install pipenv</strong>â€. And we may need â€œ<strong>pip install setuptools</strong>â€ to fix <em>â€œNo module named pkg_resourcesâ€</em>â€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>## Build NuttX Docs on macOS
cd nuttx/Documentation
brew install pipenv
pipenv install
pipenv shell
pip install setuptools
rm -r _build
make html
</code></pre></div>
<p><a href="https://gist.github.com/lupyuen/eeae419776fba2b59502fcce05bb1859">(See the Log)</a></p>
<p><img src="https://lupyuen.github.io/images/pr-nxstyle.jpg" alt="Check Coding Style with nxstyle" /></p>
<h1 id="check-coding-style"><a class="doc-anchor" href="#check-coding-style">Â§</a>3 Check Coding Style</h1>
<p>Our NuttX Code will follow this Coding Standardâ€¦</p>
<ul>
<li><a href="https://nuttx.apache.org/docs/latest/contributing/coding_style.html"><strong>â€œNuttX C Coding Standardâ€</strong></a></li>
</ul>
<p>NuttX provides a tool <strong><code>nxstyle</code></strong> that will check the Coding Style of our source filesâ€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>## Compile nxstyle
## TODO: Change &quot;$HOME/nuttx&quot; to our NuttX Project Folder
gcc -o $HOME/nxstyle $HOME/nuttx/nuttx/tools/nxstyle.c

## Check coding style for our modified source files
## TODO: Change the file paths
$HOME/nxstyle $HOME/nuttx/nuttx/arch/arm64/Kconfig
$HOME/nxstyle $HOME/nuttx/nuttx/arch/arm64/src/common/Make.defs
$HOME/nxstyle $HOME/nuttx/nuttx/arch/arm64/src/common/arm64_gic.h
$HOME/nxstyle $HOME/nuttx/nuttx/arch/arm64/src/common/arm64_gicv2.c
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/blob/master/tools/nxstyle.c">(<code>nxstyle.c</code> is here)</a></p>
<p><a href="https://gist.github.com/lupyuen/5e2fba642a33bf64d3378df3795042d7">(How I run <code>nxstyle</code> in my <strong>Build Script</strong>)</a></p>
<p><em>Will <code>nxstyle</code> check Kconfig and Makefiles?</em></p>
<p>Not yet, but maybe someday? Thatâ€™s why we passed all the modified files to <code>nxstyle</code> for checking.</p>
<p><em>How do we fix our code?</em></p>
<p>The pic above shows the output from <strong><code>nxstyle</code></strong>. Weâ€™ll see messages likeâ€¦</p>
<div class="example-wrap"><pre class="language-text"><code>- C++ style comment
- Long line found
- Mixed case identifier found
- Operator/assignment must be followed/preceded with whitespace
- Upper case hex constant found
- #include outside of &#39;Included Files&#39; section
</code></pre></div>
<p>We modify our code so that thisâ€¦</p>
<div class="example-wrap"><pre class="language-c"><code>// Initialize GIC. Called by CPU0 only.
int arm64_gic_initialize(void) {
  // Verify that GIC Version is 2
  int err = gic_validate_dist_version();
  if (err) { sinfo(&quot;no distributor detected, giving up ret=%d\n&quot;, err); return err; }

  // CPU0-specific initialization for GIC
  arm_gic0_initialize();

  // CPU-generic initialization for GIC
  arm_gic_initialize();
  return 0;
}
</code></pre></div>
<p><a href="https://github.com/lupyuen/nuttx/blob/pinephone/arch/arm64/src/common/arm64_gicv3.c#L717-L743">(Source)</a></p>
<p>Becomes thisâ€¦</p>
<div class="example-wrap"><pre class="language-c"><code>/****************************************************************************
 * Name: arm64_gic_initialize
 *
 * Description:
 *   Initialize GIC. Called by CPU0 only.
 *
 * Input Parameters
 *   None
 *
 * Returned Value:
 *   Zero (OK) on success; a negated errno value is returned on any failure.
 *
 ****************************************************************************/

int arm64_gic_initialize(void)
{
  int err;

  /* Verify that GIC Version is 2 */

  err = gic_validate_dist_version();
  if (err)
    {
      sinfo(&quot;no distributor detected, giving up ret=%d\n&quot;, err);
      return err;
    }

  /* CPU0-specific initialization for GIC */

  arm_gic0_initialize();

  /* CPU-generic initialization for GIC */

  arm_gic_initialize();

  return 0;
}
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/blob/master/arch/arm64/src/common/arm64_gicv2.c#L1325-L1363">(Source)</a></p>
<p>If we see thisâ€¦</p>
<div class="example-wrap"><pre class="language-text"><code>/* */ not balanced
</code></pre></div>
<p>Check that our stars â€œ<strong><code>*</code></strong>â€ are aligned (heh)â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>/******************************
 * Name: missing_asterisk_below
 *
 *****************************/
</code></pre></div>
<p>After fixing, <strong>test our code</strong> one last time.</p>
<h1 id="write-the-pull-request"><a class="doc-anchor" href="#write-the-pull-request">Â§</a>4 Write the Pull Request</h1>
<p>Our Pull Request will haveâ€¦</p>
<ol>
<li>
<p><strong>Title</strong>: NuttX Subsystem and One-Line Summary</p>
</li>
<li>
<p><strong>Summary</strong>: Whatâ€™s the purpose of the Pull Request? What files are changed?</p>
</li>
<li>
<p><strong>Impact</strong>: Which parts of NuttX are affected by the Pull Request? Which parts <em>wonâ€™t</em> be affected?</p>
</li>
<li>
<p><strong>Testing</strong>: Provide evidence that our Pull Request does what itâ€™s supposed to do.</p>
<p>(And that it wonâ€™t do what itâ€™s <em>not supposed</em> to do)</p>
</li>
</ol>
<p>To write the above items, letâ€™s walk through these Pull Requestsâ€¦</p>
<ul>
<li>
<p><a href="https://github.com/apache/nuttx/pull/7630"><strong>â€œarch/arm64: Add support for Generic Interrupt Controller Version 2â€</strong></a></p>
</li>
<li>
<p><a href="https://github.com/apache/nuttx/pull/7692"><strong>â€œarch/arm64: Add support for PINE64 PinePhoneâ€</strong></a></p>
</li>
</ul>
<h2 id="title"><a class="doc-anchor" href="#title">Â§</a>4.1 Title</h2>
<p>Inside our Title is the <strong>NuttX Subsystem</strong> and <strong>One-Line Summary</strong>â€¦</p>
<blockquote>
<p><em>â€œarch/arm64: Add support for Generic Interrupt Controller Version 2â€</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p>Letâ€™s write this into a <strong>Markdown File</strong> for easier copyingâ€¦</p>
<ul>
<li>
<p><a href="https://gist.github.com/lupyuen/4dbe011143dfc5404e1791ba74a79deb"><strong>Sample Pull Request</strong></a></p>
<p><a href="https://gist.githubusercontent.com/lupyuen/4dbe011143dfc5404e1791ba74a79deb/raw/b8731c9132c428050e6146c0d2097e7bb7c6eb03/sample-nuttx-pull-request.md">(See the Markdown Code)</a></p>
</li>
</ul>
<p>Weâ€™ll add the following sections to the Markdown Fileâ€¦</p>
<h2 id="summary"><a class="doc-anchor" href="#summary">Â§</a>4.2 Summary</h2>
<p>In the Summary we write the <strong>purpose of the Pull Request</strong>â€¦</p>
<blockquote>
<p><em>â€œThis PR adds support for GIC Version 2, which is needed by Pine64 PinePhone.â€</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p>And we list the <strong>files that we changed</strong>â€¦</p>
<blockquote>
<p><em>â€œ<code>arch/arm64/Kconfig</code>: Under â€œARM64 Optionsâ€, we added an integer option ARM_GIC_VERSION (â€œGIC versionâ€) that selects the GIC Version. Valid values are 2, 3 and 4, default is 3.â€œ</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p>If itâ€™s a long list, we might <strong>break into subsections</strong> like thisâ€¦</p>
<ul>
<li><a href="https://github.com/apache/nuttx/pull/7692"><strong>arch/arm64: Add support for PINE64 PinePhone</strong></a></li>
</ul>
<p>For <strong>Code Provenance</strong> itâ€™s good to state <strong>how we created the code</strong>â€¦</p>
<blockquote>
<p><em>â€œThis 64-bit implementation of GIC v2 is mostly identical to the existing GIC v2 for 32-bit Armv7-A (<a href="https://github.com/apache/incubator-nuttx/blob/master/arch/arm/src/armv7-a/arm_gicv2.c"><code>arm_gicv2.c</code></a>, <a href="https://github.com/apache/incubator-nuttx/blob/master/arch/arm/src/armv7-a/gic.h"><code>gic.h</code></a>), with minor modifications to support 64-bit Registers (Interrupt Context).â€</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p>(Adding <strong>GPL Code</strong>? Please check with the NuttX Maintainers)</p>
<h2 id="impact"><a class="doc-anchor" href="#impact">Â§</a>4.3 Impact</h2>
<p>Under â€œImpactâ€, we write <strong>which parts of NuttX are affected</strong> by the Pull Request. </p>
<p>(And which parts <em>wonâ€™t</em> be affected)</p>
<blockquote>
<p><em>â€œWith this PR, NuttX now supports GIC v2 on Arm64.</em></p>
</blockquote>
<blockquote>
<p><em>There is no impact on the existing implementation of GIC v3, as tested below.â€œ</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<h2 id="testing"><a class="doc-anchor" href="#testing">Â§</a>4.4 Testing</h2>
<p>Under â€œTestingâ€, we provide evidence that our Pull Request <strong>does what itâ€™s supposed to do.</strong> We fill in theâ€¦</p>
<ul>
<li>
<p><strong>Commands</strong> used for testing</p>
</li>
<li>
<p><strong>Output Logs</strong> captured from our testing</p>
</li>
</ul>
<p>Like thisâ€¦</p>
<blockquote>
<p><em>â€œWe tested with QEMU our implementation of GIC v2:</em></p>
</blockquote>
<blockquote>
<p><em><code>tools/configure.sh qemu-armv8a:nsh_gicv2 ; make ; qemu-system-aarch64 ...</code></em></p>
</blockquote>
<blockquote>
<p><em><a href="https://gist.github.com/lupyuen/7537da777d728a22ab379b1ef234a2d1">(See the NuttX QEMU Log)</a></em></p>
</blockquote>
<blockquote>
<p><em>The log shows that GIC v2 has correctly handled interruptsâ€œ</em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p>If we have done a <a href="https://lupyuen.github.io/articles/pr#regression-test"><strong>Regression Test</strong></a>, provide the details tooâ€¦</p>
<blockquote>
<p><em>â€œFor Regression Testing: We tested the existing implementation of GIC v3â€¦â€</em></p>
</blockquote>
<blockquote>
<p><em><code>tools/configure.sh qemu-armv8a:nsh ; make ; qemu-system-aarch64 ...</code></em></p>
</blockquote>
<blockquote>
<p><em><a href="https://gist.github.com/lupyuen/dec66bc348092a998772b32993e5ed65">(See the NuttX QEMU Log)</a></em></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Source)</a></p>
</blockquote>
<p><strong>Test Logs are super helpful</strong> for NuttX Maintainers!</p>
<p>(Because we canâ€™t tell which way the train wentâ€¦ By staring at the track!)</p>
<p>Now we tidy up our commitsâ€¦</p>
<p><img src="https://lupyuen.github.io/images/pr-squash1.png" alt="Squash Commits with GitHub Desktop" /></p>
<h1 id="squash-the-commits"><a class="doc-anchor" href="#squash-the-commits">Â§</a>5 Squash the Commits</h1>
<p><em>Whatâ€™s this â€œsquashingâ€?</em></p>
<p>â€œSquashingâ€ means weâ€™re <strong>combining Multiple Commits</strong> into One Single Commit.</p>
<p>Our <strong>Commit History</strong> can get awfully messy during developmentâ€¦</p>
<div class="example-wrap"><pre class="language-text"><code>- Initial Commit
- Fixing Build
- Build OK!
- Oops fixing bug
- Tested OK yay!
</code></pre></div>
<p><a href="https://github.com/lupyuen/nuttx/commits/pinephone/arch/arm64/src/qemu/qemu_serial.c">(Source)</a></p>
<p>So we always <strong>Squash the Commits</strong> into One Single Commit (to help future maintainers)â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>- arch/arm64: Add support for Generic Interrupt Controller Version 2
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/pull/7630/commits">(Source)</a></p>
<p><em>How do we squash the commits?</em></p>
<p>Weâ€™ll use <a href="https://desktop.github.com/"><strong>GitHub Desktop</strong></a> (because Iâ€™m terrible with the Git Command Line)â€¦</p>
<ol>
<li>
<p>Install <a href="https://desktop.github.com/"><strong>GitHub Desktop</strong></a> and launch it</p>
</li>
<li>
<p>Click â€œ<strong>File â†’ Add Local Repository</strong>â€</p>
<p>Select our downloaded <strong><code>nuttx</code></strong> folder.</p>
<p>Click â€œ<strong>Add Repository</strong>â€</p>
</li>
<li>
<p>Click the â€œ<strong>History</strong>â€ tab to reveal the Commit History</p>
<p><a href="https://lupyuen.github.io/images/pr-squash1.png">(Pic above)</a></p>
</li>
<li>
<p>Select the Commits to be Squashed.</p>
<p>Right-click the Commits.</p>
<p>Select â€œ<strong>Squash Commits</strong>â€</p>
<p><a href="https://lupyuen.github.io/images/pr-squash1.png">(Pic above)</a></p>
</li>
<li>
<p>Copy the <strong>Title</strong> of our Pull Request and paste into the <strong>Title Box</strong>â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>arch/arm64: Add support for Generic Interrupt Controller Version 2
</code></pre></div>
<p>In the <strong>Description Box</strong>, erase the old Commit Messages.</p>
<p>Copy the <strong>Summary</strong> of our Pull Request and paste into the <strong>Description Box</strong>â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>This PR adds support for GIC Version 2.
- `boards/arm64/qemu/qemu-armv8a/configs/nsh_gicv2/defconfig`: Added the Board Configuration
</code></pre></div>
<p>Click â€œ<strong>Squash Commits</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-squash2.png" alt="Squash Commits with GitHub Desktop" /></p>
</li>
<li>
<p>Click â€œ<strong>Begin Squash</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-squash3.png" alt="Squash Commits with GitHub Desktop" /></p>
</li>
<li>
<p>Click â€œ<strong>Force Push Origin</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-squash4.png" alt="Squash Commits with GitHub Desktop" /></p>
</li>
<li>
<p>Click â€œ<strong>Iâ€™m Sure</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-squash5.png" alt="Squash Commits with GitHub Desktop" /></p>
<p>And weâ€™re ready to merge upstream! (Like the salmon)</p>
</li>
</ol>
<p><em>What if we prefer the Git Command Line?</em></p>
<p>Here are the steps to Squash Commits with the <strong>Git Command Line</strong>â€¦</p>
<ul>
<li><a href="https://github.com/k88hudson/git-flight-rules#i-need-to-combine-commits"><strong>â€œFlight rules for Git: I need to combine commitsâ€</strong></a></li>
</ul>
<p><img src="https://lupyuen.github.io/images/pr-walk.jpg" alt="Taking a long walk" /></p>
<h1 id="meditate"><a class="doc-anchor" href="#meditate">Â§</a>6 Meditate</h1>
<p><strong>Breathe. Take a break.</strong></p>
<p>Weâ€™re about to make <strong>NuttX History</strong>â€¦ Our changes will be recorded for posterity!</p>
<p>Take a long walk and ponderâ€¦</p>
<ul>
<li>
<p><strong>Who might benefit</strong> from our Pull Request</p>
</li>
<li>
<p>How we might <strong>best help them</strong></p>
</li>
</ul>
<p>(I walked 12 km for 3 hours while meditating on my Pull Request)</p>
<p>If we get an inspiration or epiphany, touch up the Pull Request.</p>
<p>(And resquash the commits)</p>
<p><em>Whatâ€™s your epiphany?</em></p>
<p>Through my Pull Requests, I hope to turn NuttX into a valuable tool for teaching the internals of <strong>Smartphone Operating Systems</strong>.</p>
<p>Thatâ€™s my motivation for <a href="https://github.com/apache/nuttx/pull/7692"><strong>porting NuttX to PINE64 PinePhone</strong></a>.</p>
<p>But for nowâ€¦ Letâ€™s finish our Pull Request!</p>
<p><img src="https://lupyuen.github.io/images/pr-pullrequest1.png" alt="Submit the Pull Request" /></p>
<h1 id="submit-the-pull-request"><a class="doc-anchor" href="#submit-the-pull-request">Â§</a>7 Submit the Pull Request</h1>
<p>Finally itâ€™s time to submit our Pull Request!</p>
<ol>
<li>
<p>Create the <strong>Pull Request</strong> (pic above)</p>
</li>
<li>
<p>Verify that it has only <strong>One Single Commit</strong> (pic above)</p>
<p><a href="https://lupyuen.github.io/articles/pr#squash-the-commits">(Squash the Commits)</a></p>
</li>
<li>
<p>Copy these into the Pull Requestâ€¦</p>
<p><a href="https://lupyuen.github.io/articles/pr#title"><strong>Title</strong></a></p>
<p><a href="https://lupyuen.github.io/articles/pr#summary"><strong>Summary</strong></a></p>
<p><a href="https://lupyuen.github.io/articles/pr#impact"><strong>Impact</strong></a></p>
<p><a href="https://lupyuen.github.io/articles/pr#testing"><strong>Testing</strong></a></p>
<p><a href="https://github.com/apache/nuttx/pull/7630">(Like this)</a></p>
</li>
<li>
<p>Submit the Pull Request</p>
</li>
<li>
<p>Wait for the <strong>Automated Checks</strong> to be completed (might take an hour)â€¦</p>
<p><img src="https://lupyuen.github.io/images/pr-pullrequest2.png" alt="Automated Checks for Pull Request" /></p>
</li>
<li>
<p><strong>Fix any errors</strong> in the Automated Checks</p>
</li>
<li>
<p>Wait for the NuttX Team to <strong>review and comment</strong> on our Pull Request.</p>
<p>This might take a while (due to the time zones)â€¦ Grab a coffee and standby for fixes!</p>
<p><a href="https://lupyuen.github.io/articles/sourdough">(I bake sourdough while waiting)</a></p>
<p>If all goes Hunky Dory, our Pull Request will be <strong>approved and merged!</strong> ğŸ‰</p>
</li>
</ol>
<p>Sometimes we need to <strong>Rebase To The Latest Master</strong> due to updates in the GitHub Actions Workflow (Continuous Integration Script). Hereâ€™s howâ€¦</p>
<ol>
<li>
<p>Browse to the <strong><code>master</code></strong> branch of our <strong><code>nuttx</code></strong> repository.</p>
<p>Click â€œ<strong>Sync Fork â†’ Update Branch</strong>â€</p>
<p>(Pic below)</p>
</li>
<li>
<p>Launch <a href="https://desktop.github.com/"><strong>GitHub Desktop</strong></a></p>
<p>Click â€œ<strong>File â†’ Add Local Repository</strong>â€</p>
<p>Select our downloaded <strong><code>nuttx</code></strong> folder.</p>
<p>Click â€œ<strong>Add Repository</strong>â€</p>
</li>
<li>
<p>Check that the <strong>Current Branch</strong> is our Working Branch for the Pull Request.</p>
<p>(Like <strong><code>gic</code></strong> branch)</p>
</li>
<li>
<p>Click â€œ<strong>Fetch Origin</strong>â€</p>
</li>
<li>
<p>Click â€œ<strong>Branch â†’ Rebase Current Branch</strong>â€</p>
<p>Select the <strong><code>master</code></strong> branch</p>
<p>Click â€œ<strong>Rebase</strong>â€ and â€œ<strong>Begin Rebase</strong>â€</p>
</li>
<li>
<p>Click â€œ<strong>Force Push Origin</strong>â€ and â€œ<strong>Iâ€™m Sure</strong>â€</p>
<p><a href="https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/keeping-your-local-repository-in-sync-with-github/syncing-your-branch#rebasing-your-project-branch-onto-another-branch">(See the official docs)</a></p>
</li>
</ol>
<p><em>Is it really OK to Rebase To The Latest Master?</em></p>
<p>Normally when the GitHub Actions build fails (not due to our code), I take a <a href="https://github.com/apache/nuttx/pulls"><strong>peek at other recent Pull Requests</strong></a>.</p>
<p>If they didnâ€™t fail the build, then itâ€™s probably OK to Rebase with Master to force the Rebuild.</p>
<p><img src="https://lupyuen.github.io/images/pr-update.png" alt="Pull Updates from NuttX Mainline" /></p>
<h1 id="update-our-repositories"><a class="doc-anchor" href="#update-our-repositories">Â§</a>8 Update Our Repositories</h1>
<p>After our Pull Request has been merged into NuttX Mainline, <strong>pull the updates</strong> into our repositoriesâ€¦</p>
<ol>
<li>
<p>Browse to the <strong><code>master</code></strong> branch of our <strong><code>nuttx</code></strong> repository.</p>
<p>Click â€œ<strong>Sync Fork â†’ Update Branch</strong>â€</p>
<p>(Pic above)</p>
</li>
<li>
<p>Do the same for the <strong><code>master</code></strong> branch of our <strong><code>apps</code></strong> repository.</p>
<p>Click â€œ<strong>Sync Fork â†’ Update Branch</strong>â€</p>
</li>
<li>
<p>Test the code from the <strong><code>master</code></strong> branch of our <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> repositories.</p>
</li>
</ol>
<p>When weâ€™re ready to add our <strong>next awesome feature</strong>â€¦</p>
<ol>
<li>
<p>Pull the updates from NuttX Mainline into our <strong><code>nuttx</code></strong> repositoryâ€¦</p>
<p>Select the <strong><code>master</code></strong> branch.</p>
<p>Click â€œ<strong>Sync Fork â†’ Update Branch</strong>â€</p>
<p>(Pic above)</p>
</li>
<li>
<p>Do the same for our <strong><code>apps</code></strong> repository.</p>
</li>
<li>
<p>In our <strong><code>nuttx</code></strong> repository, click <strong><code>master</code></strong>.</p>
<p>Enter the name of our new branch.</p>
<p>Click â€œ<strong>Create Branch</strong>â€</p>
<p><img src="https://lupyuen.github.io/images/pr-branch.png" alt="Create Branch" /></p>
</li>
<li>
<p>Do the same for our <strong><code>apps</code></strong> repository.</p>
</li>
<li>
<p>Modify the code in the new branch of our <strong><code>nuttx</code></strong> and <strong><code>apps</code></strong> repositories.</p>
<p>Build, test and submit our new Pull Request.</p>
</li>
</ol>
<p>And thatâ€™s the Complete Lifecycle of a Pull Request for Apache NuttX RTOS!</p>
<p>One last thing: Please help to validate that the <strong>NuttX Release works OK</strong>! We really appreciate your help with thisâ€¦ ğŸ™</p>
<ul>
<li><a href="https://lupyuen.github.io/articles/pr#appendix-validate-nuttx-release"><strong>â€œValidate NuttX Releaseâ€</strong></a></li>
</ul>
<h1 id="whats-next"><a class="doc-anchor" href="#whats-next">Â§</a>9 Whatâ€™s Next</h1>
<p>I hope this article will be helpful for folks contributing code to NuttX for the very first time.</p>
<p>In the next article weâ€™ll explain this complex Pull Request that adds a <strong>new SoC and new Board</strong> to NuttX. Stay Tuned!</p>
<ul>
<li>
<p><a href="https://lupyuen.github.io/articles/release#add-the-nuttx-arch-and-board"><strong>â€œAdd the NuttX Arch and Boardâ€</strong></a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io/articles/release#update-the-nuttx-docs"><strong>â€œUpdate the NuttX Docsâ€</strong></a></p>
</li>
</ul>
<p>Many Thanks to my <a href="https://github.com/sponsors/lupyuen"><strong>GitHub Sponsors</strong></a> for supporting my work! This article wouldnâ€™t have been possible without your support.</p>
<ul>
<li>
<p><a href="https://github.com/sponsors/lupyuen"><strong>Sponsor me a coffee</strong></a></p>
</li>
<li>
<p><a href="https://github.com/lupyuen/nuttx-ox64"><strong>My Current Project: â€œApache NuttX RTOS for Ox64 BL808â€</strong></a></p>
</li>
<li>
<p><a href="https://github.com/lupyuen/nuttx-star64"><strong>My Other Project: â€œNuttX for Star64 JH7110â€</strong></a></p>
</li>
<li>
<p><a href="https://github.com/lupyuen/pinephone-nuttx"><strong>Older Project: â€œNuttX for PinePhoneâ€</strong></a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io"><strong>Check out my articles</strong></a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io/rss.xml"><strong>RSS Feed</strong></a></p>
</li>
</ul>
<p><em>Got a question, comment or suggestion? Create an Issue or submit a Pull Request hereâ€¦</em></p>
<p><a href="https://github.com/lupyuen/lupyuen.github.io/blob/master/src/pr.md"><strong>lupyuen.github.io/src/pr.md</strong></a></p>
<h1 id="notes"><a class="doc-anchor" href="#notes">Â§</a>10 Notes</h1>
<ol>
<li>
<p>When we modify the <strong>Kconfig</strong> Configuration Files, remember to update the <strong>defconfig</strong> Configuration Files!</p>
<p><a href="https://github.com/apache/nuttx/pull/9243#issuecomment-1542918859">(Like this)</a></p>
<p>What happens if we forget to update <strong>defconfig</strong>â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>Configuration/Tool: pinephone/sensor
Building NuttX...
Normalize pinephone/sensor
71d70
&lt; CONFIG_UART1_SERIAL_CONSOLE=y
Saving the new configuration file
HEAD detached at pull/9243/merge
Changes not staged for commit:
(use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
(use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
    modified:   boards/arm64/a64/pinephone/configs/sensor/defconfig
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/pull/9243#issuecomment-1542918859">(Source)</a></p>
</li>
<li>
<p>How do we create a new <strong>defconfig</strong>?</p>
<p>In the â€œ<strong>nuttx/nuttx</strong>â€ folder, run thisâ€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>make savedefconfig
</code></pre></div>
<p>This creates the file <strong>defconfig</strong> that contains the changed settings.</p>
<p>Copy the <strong>defconfig</strong> file to the new <strong>config</strong> subfolderâ€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>mkdir boards/&lt;archname&gt;/&lt;chipname&gt;/&lt;boardname&gt;/config/&lt;mynewcustomconfig&gt;

mv defconfig boards/&lt;archname&gt;/&lt;chipname&gt;/&lt;boardname&gt;/config/&lt;mynewcustomconfig&gt;/
</code></pre></div>
<p><a href="https://www.mail-archive.com/dev@nuttx.apache.org/msg09876.html">(Thanks to <strong>Alan C. Assis</strong> for the tip!)</a></p>
</li>
<li>
<p>Some Default Settings in <strong>.config</strong> are missing from <strong>defconfig</strong>. Can we copy them ourselves to <strong>defconfig</strong>?</p>
<p>Sorry it wonâ€™t work. Suppose we copy these Default UART3 Settings from <strong>.config</strong> to <strong>defconfig</strong> (to hard-code the UART3 Baud Rate)â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>CONFIG_UART3_BAUD=115200
CONFIG_UART3_BITS=8
CONFIG_UART3_PARITY=0
CONFIG_UART3_2STOP=0
</code></pre></div>
<p>The â€œLinux (Other)â€ Build will fail with this errorâ€¦</p>
<div class="example-wrap"><pre class="language-text"><code>Configuration/Tool: pinephone/modem
Building NuttX...
Normalize pinephone/modem
69,72d68
&lt; CONFIG_UART3_BAUD=115200
&lt; CONFIG_UART3_BITS=8
&lt; CONFIG_UART3_PARITY=0
&lt; CONFIG_UART3_2STOP=0
Saving the new configuration file
HEAD detached at pull/9304/merge
Changes not staged for commit:
(use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
(use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
    modified:   boards/arm64/a64/pinephone/configs/modem/defconfig
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/actions/runs/4997328093/jobs/8951602341">(Source)</a></p>
<p>Thus we canâ€™t copy any Default Settings in <strong>.config</strong> to <strong>defconfig</strong>.</p>
</li>
<li>
<p>If the auto-build fails with <strong>â€œUntracked etctmpâ€</strong>â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>HEAD detached at pull/11379/merge
Untracked files: (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
boards/risc-v/k230/canmv230/src/etctmp.c
boards/risc-v/k230/canmv230/src/etctmp/
</code></pre></div>
<p><a href="https://github.com/apache/nuttx/actions/runs/7203675079/job/19625255417?pr=11379">(Source)</a></p>
<p>Check that we have added â€œ<strong>etctmp</strong>â€ to the <strong>Board-Specific Git Ignore</strong>: <a href="https://github.com/apache/nuttx/blob/master/boards/risc-v/jh7110/star64/src/.gitignore">boards/risc-v/jh7110/star64/src/.gitignore</a></p>
<div class="example-wrap"><pre class="language-text"><code>etctmp
etctmp.c
</code></pre></div></li>
<li>
<p>Hereâ€™s an excellent guide for the <strong>Git Command Line</strong>â€¦</p>
<p><a href="https://github.com/k88hudson/git-flight-rules"><strong>â€œFlight rules for Gitâ€</strong></a></p>
</li>
<li>
<p>Converting our code to the <a href="https://nuttx.apache.org/docs/latest/contributing/coding_style.html"><strong>â€œNuttX C Coding Standardâ€</strong></a>â€¦</p>
<p>Can we automate this with a <strong>VSCode Extension?</strong></p>
<p>Maybe like the <a href="https://marketplace.visualstudio.com/items?itemName=idanp.checkpatch"><strong>Linux checkpatch Extension</strong></a>, but it will actually auto-reformat our lines?</p>
</li>
<li>
<p><a href="https://www.qemu.org/docs/master/system/target-arm.html"><strong>QEMU Emulator</strong></a> is incredibly helpful for Regression Testingâ€¦</p>
<p>Can we extend it to <strong>emulate PinePhone</strong>? Maybe just the UART Hardware? Check out the articlesâ€¦</p>
<p><a href="https://lupyuen.github.io/articles/unicorn"><strong>â€œ(Possibly) Emulate PinePhone with Unicorn Emulatorâ€</strong></a></p>
<p><a href="https://lupyuen.github.io/articles/unicorn2"><strong>â€œ(Clickable) Call Graph for Apache NuttX Real-Time Operating Systemâ€</strong></a></p>
</li>
</ol>
<h1 id="appendix-validate-nuttx-release"><a class="doc-anchor" href="#appendix-validate-nuttx-release">Â§</a>11 Appendix: Validate NuttX Release</h1>
<p><em>For each Official Release of NuttX, how do we check if it runs OK on all devices? Like PinePhone, ESP32, BL602, â€¦</em></p>
<p>NuttX needs to be <strong>tested on every device</strong>, and we need your help! ğŸ™</p>
<p>Before every Official Release of NuttX, a <strong>Validation Request</strong> will be broadcast on the <a href="https://nuttx.apache.org/community/"><strong>NuttX Developers Mailing List</strong></a>â€¦</p>
<ul>
<li><a href="https://www.mail-archive.com/dev@nuttx.apache.org/msg09563.html"><strong>Validation Request for NuttX Release</strong></a></li>
</ul>
<p>Follow the instructions here to validate that the NuttX Release <strong>builds correctly and runs OK</strong> on your deviceâ€¦</p>
<ul>
<li>
<p><a href="https://cwiki.apache.org/confluence/display/NUTTX/Validating+a+staged+Release"><strong>Validating a Staged Release</strong></a></p>
<p>(See below for the updates)</p>
</li>
</ul>
<p>Hereâ€™s the script I run to <strong>validate NuttX on PinePhone</strong>â€¦</p>
<ul>
<li><a href="https://gist.github.com/lupyuen/a08d3d478beefc5a492ed2dae39438f3"><strong>Validation Script for PinePhone: release.sh</strong></a></li>
</ul>
<p>And hereâ€™s the output of the <strong>validation script</strong>â€¦</p>
<ul>
<li><a href="https://gist.github.com/lupyuen/5760e0375d44a06b3c730a10614e4d24"><strong>Validation Output for PinePhone: release.log</strong></a></li>
</ul>
<p>Boot NuttX on our device, run â€œ<strong>uname -a</strong>â€ and â€œ<strong>free</strong>â€â€¦</p>
<div class="example-wrap"><pre class="language-text"><code>NuttShell (NSH) NuttX-12.1.0
nsh&gt; uname -a
NuttX 12.1.0 d40f4032fc Apr 12 2023 07:11:20 arm64 pinephone
nsh&gt; free
      total     used   free      largest   nused nfree
Umem: 133414240 550768 132863472 132863376 56    2
</code></pre></div>
<p>The <strong>NuttX Hash</strong> (like â€œd40f4032fcâ€ above) should match the <a href="https://www.mail-archive.com/dev@nuttx.apache.org/msg09563.html"><strong>Validation Request</strong></a>.</p>
<p>Copy the above into a <strong>Validation Response</strong> emailâ€¦</p>
<ul>
<li><a href="https://www.mail-archive.com/dev@nuttx.apache.org/msg09565.html"><strong>Validation Response for NuttX Release</strong></a></li>
</ul>
<p>And send back to the Mailing List. (Assuming all is hunky dory)</p>
<p>Since there are so many NuttX devices, we really appreciate your help with the NuttX Validation! ğŸ™</p>
<p><em>What are the updates to the NuttX Validation Instructions?</em></p>
<p>The <a href="https://cwiki.apache.org/confluence/display/NUTTX/Validating+a+staged+Release"><strong>NuttX Validation Instructions</strong></a> should be updatedâ€¦</p>
<ul>
<li>
<p>To verify the NuttX Signature, we need to <strong>import the NuttX Keys</strong>â€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>wget https://dist.apache.org/repos/dist/dev/nuttx/KEYS
gpg --import KEYS
</code></pre></div></li>
<li>
<p>We also need to <strong>trust the NuttX Keys</strong>â€¦</p>
<div class="example-wrap"><pre class="language-bash"><code>gpg --edit-key 9208D2E4B800D66F749AD4E94137A71698C5E4DB
</code></pre></div>
<p>(Thatâ€™s the RSA Key Fingerprint from â€œ<strong>gpg â€“verify</strong>â€)</p>
<p>Then enter â€œ<strong>trust</strong>â€ and â€œ<strong>5</strong>â€</p>
</li>
<li>
<p>The file â€œ<strong>DISCLAIMER-WIP</strong>â€ no longer exists in the <strong>nuttx</strong> and <strong>apps</strong> folders</p>
</li>
</ul>

    
    <!-- Begin scripts/rustdoc-after.html: Post-HTML for Custom Markdown files processed by rustdoc, like chip8.md -->

    <!-- Begin Theme Picker and Prism Theme -->
    <script src="../theme.js"></script>
    <script src="../prism.js"></script>
    <!-- Theme Picker and Prism Theme -->

    <!-- End scripts/rustdoc-after.html -->
    

</body>
</html>