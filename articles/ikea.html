<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>Connect IKEA Air Quality Sensor to Apache NuttX OS</title>

    
    <!-- Begin scripts/articles/*-header.html: Article Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<meta property="og:title" 
    content="Connect IKEA Air Quality Sensor to Apache NuttX OS" 
    data-rh="true">
<meta property="og:description" 
    content="How we expose the UART Port on IKEA VINDRIKTNING Air Quality Sensor... And read the PM 2.5 data with PineDio Stack BL604 RISC-V Board"
    data-rh="true">
<meta property="og:image" 
    content="https://lupyuen.github.io/images/ikea-title.jpg">
<meta property="og:type" 
    content="article" data-rh="true">
<!-- End scripts/articles/*-header.html -->
<!-- Begin scripts/rustdoc-header.html: Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<link rel="alternate" type="application/rss+xml" title="RSS Feed for lupyuen" href="/rss.xml" />
<link rel="stylesheet" type="text/css" href="../normalize.css">
<link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle">
<link rel="stylesheet" type="text/css" href="../dark.css">
<link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle">
<link rel="stylesheet" type="text/css" href="../prism.css">
<script src="../storage.js"></script><noscript>
<link rel="stylesheet" href="../noscript.css"></noscript>
<link rel="shortcut icon" href="../favicon.ico">
<style type="text/css">
    #crate-search {
        background-image: url("../down-arrow.svg");
    }
    a {
        color: #77d;
    }
</style>
<!-- End scripts/rustdoc-header.html -->


</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

        <!-- Begin scripts/rustdoc-before.html: Pre-HTML for Custom Markdown files processed by rustdoc, like chip8.md -->

    <!-- Begin Theme Picker -->
    <div class="theme-picker" style="left: 0"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg"
        width="18" alt="Pick another theme!"></button>
        <div id="theme-choices"></div>
    </div>
    <script src="../theme.js"></script>
    <script src="../prism.js"></script>
    <!-- Theme Picker -->

    <!-- End scripts/rustdoc-before.html -->
    

    <h1 class="title">Connect IKEA Air Quality Sensor to Apache NuttX OS</h1>
    <nav id="TOC"><ul>
<li><a href="#about-ikea-air-quality-sensor">1 About IKEA Air Quality Sensor</a><ul></ul></li>
<li><a href="#solder-uart-port">2 Solder UART Port</a><ul></ul></li>
<li><a href="#connect-to-pinedio-stack-bl604">3 Connect to PineDio Stack BL604</a><ul></ul></li>
<li><a href="#nuttx-app">4 NuttX App</a><ul>
<li><a href="#sensor-data-frame">4.1 Sensor Data Frame</a><ul></ul></li>
<li><a href="#main-loop">4.2 Main Loop</a><ul></ul></li>
<li><a href="#validate-sensor-data">4.3 Validate Sensor Data</a><ul></ul></li>
<li><a href="#process-sensor-data">4.4 Process Sensor Data</a><ul></ul></li></ul></li>
<li><a href="#run-nuttx-app">5 Run NuttX App</a><ul></ul></li>
<li><a href="#install-app">6 Install App</a><ul></ul></li>
<li><a href="#configure-apache-nuttx-os">7 Configure Apache NuttX OS</a><ul></ul></li>
<li><a href="#output-log">8 Output Log</a><ul></ul></li>
<li><a href="#test-with-apache-nuttx-os">9 Test with Apache NuttX OS</a><ul></ul></li>
<li><a href="#connect-to-lorawan-and-the-things-network">10 Connect to LoRaWAN and The Things Network</a><ul></ul></li>
<li><a href="#visualise-with-prometheus-and-grafana">11 Visualise with Prometheus and Grafana</a><ul></ul></li>
<li><a href="#references">12 References</a><ul></ul></li>
<li><a href="#whats-next">13 What‚Äôs Next</a><ul></ul></li>
<li><a href="#notes">14 Notes</a><ul></ul></li>
<li><a href="#appendix-solder-uart-port-on-ikea-vindriktning-air-quality-sensor">15 Appendix: Solder UART Port on IKEA VINDRIKTNING Air Quality Sensor</a><ul></ul></li>
<li><a href="#appendix-test-with-bus-pirate">16 Appendix: Test with Bus Pirate</a><ul>
<li><a href="#ascii-log">16.1 ASCII Log</a><ul></ul></li>
<li><a href="#binary-log">16.2 Binary Log</a><ul></ul></li></ul></li></ul></nav><p>üìù <em>16 Feb 2022</em></p>
<p><img src="https://lupyuen.github.io/images/ikea-title.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor seated on Pine64 PineDio LoRa Gateway" /></p>
<p><em><a href="https://www.ikea.com/us/en/p/vindriktning-air-quality-sensor-60515911">IKEA VINDRIKTNING Air Quality Sensor</a> seated on <a href="https://lupyuen.github.io/articles/gateway">Pine64 PineDio LoRa Gateway</a></em></p>
<p><a href="https://www.ikea.com/us/en/p/vindriktning-air-quality-sensor-60515911"><strong>IKEA VINDRIKTNING</strong></a> is a $12 hackable Air Quality Sensor that measures <a href="https://www.epa.gov/pm-pollution/particulate-matter-pm-basics"><strong>PM 2.5 (Particulate Matter</strong>)</a> with reasonable accuracy.</p>
<p>Let‚Äôs connect the IKEA Sensor to a RISC-V Microcontroller Board: <a href="https://lupyuen.github.io/articles/pinedio"><strong>Pine64 PineDio Stack BL604</strong></a> (pic below) running on <a href="https://lupyuen.github.io/articles/nuttx"><strong>Apache NuttX</strong></a> operating system.</p>
<p>(Our code will run on ESP32 too)</p>
<p><em>Why are we doing this?</em></p>
<ul>
<li>
<p>The sensor is <strong>affordable and available</strong> at our local IKEA store</p>
</li>
<li>
<p>Might be a fun intro to <strong>Embedded Programming</strong></p>
</li>
<li>
<p>But some <strong>soldering needed!</strong> We‚Äôll walk through the steps.</p>
</li>
<li>
<p><strong>Apache NuttX</strong> is a tiny Linux-like operating system for microcontrollers. So our code will look familiar to Linux coders.</p>
</li>
<li>
<p>Eventually we‚Äôll transmit the PM 2.5 data wirelessly over <a href="https://makezine.com/2021/05/24/go-long-with-lora-radio/"><strong>LoRaWAN</strong></a> to <a href="https://makezine.com/2021/05/24/go-long-with-lora-radio/"><strong>The Things Network</strong></a>. (Thanks to the onboard LoRa Transceiver on PineDio Stack)</p>
</li>
<li>
<p>Imagine connecting a community of Air Quality Sensors miles apart (because of LoRa‚Äôs long range). That would be super interesting for <strong>Environment Monitoring</strong>!</p>
</li>
</ul>
<p>In a while we‚Äôll dive into the code that talks to the IKEA Sensor‚Ä¶</p>
<ul>
<li><a href="https://github.com/lupyuen/ikea_air_quality_sensor"><strong>lupyuen/ikea_air_quality_sensor</strong></a></li>
</ul>
<p>But first let‚Äôs solder and wire up the IKEA Sensor!</p>
<p><em>Will it work with Arduino?</em></p>
<p>Check out these projects‚Ä¶</p>
<ul>
<li>
<p><a href="https://github.com/Hypfer/esp8266-vindriktning-particle-sensor"><strong>esp8266-vindriktning-particle-sensor</strong></a></p>
</li>
<li>
<p><a href="https://style.oversubstance.net/2021/08/diy-use-an-ikea-vindriktning-air-quality-sensor-in-home-assistant-with-esphome/"><strong>ESPHome on ESP32</strong></a></p>
</li>
</ul>
<p><img src="https://lupyuen.github.io/images/loader-title.jpg" alt="Pine64 PineDio Stack BL604 RISC-V Board" /></p>
<p><a href="https://lupyuen.github.io/articles/pinedio"><em>Pine64 PineDio Stack BL604 RISC-V Board</em></a></p>
<h1 id="about-ikea-air-quality-sensor" class="section-header"><a href="#about-ikea-air-quality-sensor">1 About IKEA Air Quality Sensor</a></h1>
<p>I found the VINDRIKTNING sensor at my local IKEA Store (IKEA Tampines Singapore) in the Lighting Section‚Ä¶</p>
<p>(Near the Air Purifiers. Wow IKEA has Air Purifiers now)</p>
<p><img src="https://lupyuen.github.io/images/ikea-sensor3.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor at IKEA Tampines Singapore" /></p>
<p>Connect the sensor to a USB-C Power Cable (not included) and it lights up in <strong>Red, Amber or Green</strong>‚Ä¶</p>
<p><img src="https://lupyuen.github.io/images/ikea-sensor4.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor" /></p>
<div><table><thead><tr><th>Colour</th><th align="center">PM 2.5 (Œºg/m¬≥)</th><th>Air Quality</th></tr></thead><tbody>
<tr><td>Green</td><td align="center">0 - 35</td><td>Good</td></tr>
<tr><td>Amber</td><td align="center">36 - 85</td><td>OK</td></tr>
<tr><td>Red</td><td align="center">86 and above</td><td>Not good</td></tr>
</tbody></table>
</div>
<p><a href="https://youtu.be/wyXb3aSPet4">(Watch it in action on YouTube)</a></p>
<p><a href="https://www.ikea.com/us/en/manuals/vindriktning-air-quality-sensor__AA-2289325-1.pdf">(IKEA VINDRIKTNING Manual)</a></p>
<p><em>Huh? This sensor outputs only 3 levels of Air Quality?</em></p>
<p>Actually the sensor is capable of measuring PM 2.5 from <strong>0 to 1,000 Œºg/m¬≥</strong>‚Ä¶ Just that we need to <strong>wire it ourselves</strong> to get the PM 2.5 value.</p>
<p>The brilliant folks at the <a href="https://community.home-assistant.io/t/ikea-vindriktning-air-quality-sensor/324599"><strong>Home Assistant Project</strong></a> discovered that inside the IKEA Sensor is a <a href="http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf"><strong>PM1006 Infrared LED Particle Sensor</strong></a>‚Ä¶</p>
<p><img src="https://lupyuen.github.io/images/ikea-datasheet.png" alt="PM1006 Infrared LED Particle Sensor" /></p>
<p><a href="http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf">(From PM1006 Datasheet)</a></p>
<p>The PM1006 Sensor exposes a <strong>UART (Serial) Port</strong> that transmits the PM 2.5 value, encoded like so‚Ä¶</p>
<p><img src="https://lupyuen.github.io/images/ikea-datasheet2.png" alt="PM1006 Sensor transmits PM 2.5 over UART" /></p>
<p><a href="http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf">(From PM1006 Datasheet)</a></p>
<p>To get the PM 2.5 data, let‚Äôs wire up the UART Port with a little soldering.</p>
<p>(FYI: Inside the IKEA Sensor is another microcontroller that talks to PM1006. Periodically it triggers the PM1006 command that measures PM 2.5)</p>
<p><a href="https://lupyuen.github.io/articles/ikea#notes">(Caution: The UART Port runs at 4.5V)</a></p>
<p><img src="https://lupyuen.github.io/images/ikea-solder.jpg" alt="Inside the IKEA VINDRIKTNING Air Quality Sensor" /></p>
<h1 id="solder-uart-port" class="section-header"><a href="#solder-uart-port">2 Solder UART Port</a></h1>
<p>Follow these steps to <strong>solder the UART (Serial) Port</strong> on the IKEA VINDRIKTNING Sensor (so we can access the PM 2.5 data)‚Ä¶</p>
<ol>
<li>
<p>Unscrew the <strong>4 screws</strong> on the back of the IKEA Sensor</p>
</li>
<li>
<p>Flip open the <strong>Back Cover</strong> to reveal the Circuit Board</p>
<p>(Pic above)</p>
</li>
<li>
<p><strong>Solder these Circular Pads</strong> on the Circuit Board‚Ä¶</p>
<div><table><thead><tr><th align="center">IKEA Sensor</th><th align="center">UART Pin</th><th align="center">Wire Colour</th></tr></thead><tbody>
<tr><td align="center">REST</td><td align="center">TX</td><td align="center">Blue</td></tr>
<tr><td align="center">GND</td><td align="center">GND</td><td align="center">Black</td></tr>
</tbody></table>
</div>
<p>(Pic below)</p>
</li>
<li>
<p>Stay clear of the <strong>Surface Mounted Components!</strong></p>
<p>(Near the GND Pad)</p>
</li>
<li>
<p>Pardon my horrid soldering‚Ä¶</p>
<p>If you‚Äôre curious how I did it, check the Appendix for the <strong>Soldering Steps</strong>.</p>
<p>(Hint: Use Sticky Tape and very fine Solder Wire)</p>
</li>
<li>
<p>Test our handiwork with a <strong>Multimeter</strong>.</p>
<p>Note that the REST and GND Pins are exposed as tiny strips at the top of the pic below. Perfect for Multimeter Testing!</p>
</li>
<li>
<p>Optional: I used <strong>Bus Pirate</strong> to sniff the UART Port and inspect the data transmitted by the sensor. See the details in the Appendix.</p>
</li>
</ol>
<p><img src="https://lupyuen.github.io/images/ikea-solder3.jpg" alt="UART Port soldered to IKEA VINDRIKTNING Air Quality Sensor" /></p>
<h1 id="connect-to-pinedio-stack-bl604" class="section-header"><a href="#connect-to-pinedio-stack-bl604">3 Connect to PineDio Stack BL604</a></h1>
<p>Now that we have exposed the UART Port on IKEA Air Quality Sensor, let‚Äôs connect it to our Microcontroller Board: <a href="https://lupyuen.github.io/articles/pinedio"><strong>PineDio Stack BL604</strong></a></p>
<div><table><thead><tr><th align="center">Function</th><th align="center">GPIO</th><th align="center">PineDio Stack</th><th align="center">IKEA Sensor</th><th align="center">Wire Colour</th></tr></thead><tbody>
<tr><td align="center">RX</td><td align="center">3</td><td align="center">Pin 14</td><td align="center">REST</td><td align="center">Blue</td></tr>
<tr><td align="center">TX</td><td align="center">4</td><td align="center">Pin 13</td><td align="center">Unused</td><td align="center"></td></tr>
<tr><td align="center">GND</td><td align="center">GND</td><td align="center">Pin 20</td><td align="center">GND</td><td align="center">Black</td></tr>
</tbody></table>
</div>
<p><a href="https://lupyuen.github.io/articles/pinedio#logic-analyser">(‚ÄúPineDio Stack‚Äù column refers to the 20-pin GPIO Connector on PineDio Stack)</a></p>
<p><img src="https://lupyuen.github.io/images/ikea-pinedio.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor connected to Pine64 PineDio Stack BL604 RISC-V Board" /></p>
<p>The <strong>GPIO Pin Numbers</strong> for the UART Port (UART1) are defined in <a href="https://github.com/lupyuen/incubator-nuttx/blob/ikea/boards/risc-v/bl602/bl602evb/include/board.h#L63-L66">board.h</a></p>
<div class="example-wrap"><pre class="language-c"><code>#define BOARD_UART_1_RX_PIN \
  (GPIO_INPUT     | GPIO_PULLUP | \
   GPIO_FUNC_UART | GPIO_PIN3)

#define BOARD_UART_1_TX_PIN \
  (GPIO_INPUT     | GPIO_PULLUP | \
   GPIO_FUNC_UART | GPIO_PIN4)</code></pre></div>
<p><strong>For ESP32:</strong> The GPIO Pin Numbers for the UART Port (UART1) are defined in <a href="https://github.com/lupyuen/incubator-nuttx/blob/ikea/arch/xtensa/src/esp32/Kconfig#L661-L669">Kconfig</a></p>
<div class="example-wrap"><pre class="language-text"><code>config ESP32_UART1_TXPIN
  int &quot;UART1 Tx Pin&quot;
  default 10
  range 0 39

config ESP32_UART1_RXPIN
  int &quot;UART1 Rx Pin&quot;
  default 9
  range 0 39</code></pre></div>
<p>Connect the <strong>USB Ports</strong> of IKEA Sensor and PineDio Stack to our computer.</p>
<p>(Remember: <strong>Only One Power Source</strong> for both gadgets!)</p>
<p>It looks messy with 2 USB Cables hanging off our computer, but we‚Äôll live with it for now‚Ä¶</p>
<blockquote>
<p><img src="https://lupyuen.github.io/images/ikea-pinedio2.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor and Pine64 PineDio Stack BL604 RISC-V Board connected to our computer" /></p>
</blockquote>
<h1 id="nuttx-app" class="section-header"><a href="#nuttx-app">4 NuttX App</a></h1>
<p>We‚Äôre all ready to read the PM 2.5 data from the IKEA Air Quality Sensor!</p>
<p>Let‚Äôs dive into the Source Code of our NuttX App that will <strong>read and process the PM 2.5 data</strong>‚Ä¶</p>
<ul>
<li><a href="https://github.com/lupyuen/ikea_air_quality_sensor/blob/main/ikea_air_quality_sensor_main.c"><strong>ikea_air_quality_sensor_main.c</strong></a></li>
</ul>
<p>But first: What‚Äôs inside the PM 2.5 data?</p>
<p><img src="https://lupyuen.github.io/images/ikea-datasheet3.png" alt="PM1006 Sensor transmits PM 2.5 over UART" /></p>
<p><a href="http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf">(From PM1006 Datasheet)</a></p>
<h2 id="sensor-data-frame" class="section-header"><a href="#sensor-data-frame">4.1 Sensor Data Frame</a></h2>
<p>The IKEA Sensor transmits a stream of <strong>Sensor Data</strong> that looks like this‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>16  11  0B  00  00  00  17  00  00  02  FF  00  00  00  21  02  00  00  0B  88
16  11  0B  00  00  00  17  00  00  02  FF  00  00  00  21  02  00  00  0B  88
16  11  0B  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0B  80
16  11  0B  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0B  80</code></pre></div>
<p><a href="https://youtu.be/TyG-dJCx8OQ">(Watch the demo on YouTube)</a></p>
<p>See the pattern? The data comes in chunks of <strong>20 bytes</strong>. Let‚Äôs call it a <strong>Sensor Data Frame</strong>.</p>
<p>Each Sensor Data Frame <strong>starts with this header</strong>‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>16  11  0B</code></pre></div>
<p>If we look back at the <a href="http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf"><strong>PM1006 Datasheet</strong></a> (pic above), we realise that the 20-byte Sensor Data Frame (‚ÄúResponse‚Äù) may be decoded like so‚Ä¶</p>
<div><table><thead><tr><th align="left">Field</th><th align="left">Value</th></tr></thead><tbody>
<tr><td align="left">Header</td><td align="left"><code>16 11 0B</code></td></tr>
<tr><td align="left"><em>(Unused)</em></td><td align="left"><code>00 00</code></td></tr>
<tr><td align="left"><strong>PM 2.5</strong></td><td align="left"><strong><code>00 17</code></strong></td></tr>
<tr><td align="left"><em>(Unused)</em></td><td align="left"><code>00 00 02 FF 00 00</code></td></tr>
<tr><td align="left"><em>(Unused)</em></td><td align="left"><code>00 21 02 00 00 0B</code></td></tr>
<tr><td align="left">Checksum</td><td align="left"><code>88</code></td></tr>
</tbody></table>
</div>
<p>This gives the <strong>PM 2.5 value of 23</strong> (<code>0x0017</code>).</p>
<p><em>What about the Checksum?</em></p>
<p>To validate the Checksum, all 20 bytes <strong>must add up to 0</strong>.</p>
<p>We skip the Sensor Data Frames that don‚Äôt add up to 0.</p>
<p>Thus we have a plan for <strong>reading and processing</strong> the PM 2.5 data‚Ä¶</p>
<ol>
<li>
<p><strong>Read the data</strong> into a 20-byte Sensor Data Frame</p>
<p>(We shift the data into the 20-byte frame, byte by byte)</p>
</li>
<li>
<p><strong>Check the Header</strong> in the Sensor Data Frame</p>
<p>(Header should be <code>16 11 0B</code>)</p>
</li>
<li>
<p><strong>Validate the Checksum</strong> in the Sensor Data Frame</p>
<p>(All bytes must add up to 0)</p>
</li>
<li>
<p><strong>Extract the PM 2.5 value</strong> from the Sensor Data Frame</p>
<p>(And process the PM 2.5 value)</p>
</li>
</ol>
<h2 id="main-loop" class="section-header"><a href="#main-loop">4.2 Main Loop</a></h2>
<p>This is the <strong>Main Loop</strong> that runs the steps above: <a href="https://github.com/lupyuen/ikea_air_quality_sensor/blob/main/ikea_air_quality_sensor_main.c#L46-L77">ikea_air_quality_sensor_main.c</a></p>
<div class="example-wrap"><pre class="language-c"><code>//  Current data in the Sensor Data Frame (20 bytes)
static uint8_t frame[20];

//  Read and process the Sensor Data from IKEA Air Quality Sensor
int main(int argc, FAR char *argv[]) {

  //  Open the UART port
  int fd = open(&quot;/dev/ttyS1&quot;, O_RDONLY);
  if (fd &lt; 0) { printf(&quot;Unable to open /dev/ttyS1\n&quot;); return 1; }</code></pre></div>
<p>We begin by <strong>opening the UART Port</strong> at <strong>/dev/ttyS1</strong>.</p>
<p>Next we loop forever, <strong>reading bytes from the UART Port</strong> and handling them‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>  //  Forever process bytes from the UART port
  for (;;) {
    //  Read a byte from the UART port
    char ch;
    read(fd, &amp;ch, 1);
    printf(&quot;%02x  &quot;, ch);</code></pre></div>
<p>After reading a byte, we shift it into the <strong>Sensor Data Frame</strong> (20 bytes)‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>    //  Append to Sensor Data Frame after shifting the bytes.
    //  We always append bytes to the frame (instead of replacing bytes)
    //  because UART is unreliable and bytes may be dropped.
    for (int i = 0; i &lt; sizeof(frame) - 1; i++) {
      frame[i] = frame[i + 1];
    }
    frame[sizeof(frame) - 1] = ch;</code></pre></div>
<p>We check if the Sensor Data Frame contains a valid <strong>Header and Checksum</strong>‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>    //  If frame is complete and valid...
    if (frame_is_valid()) {
      //  Process the frame
      process_frame();
    }   </code></pre></div>
<p>If the Sensor Data Frame is valid, we process the data in the frame.</p>
<p>Let‚Äôs jump into <strong>frame_is_valid</strong> and <strong>process_frame</strong>.</p>
<p><img src="https://lupyuen.github.io/images/ikea-code2.png" alt="Main Loop" /></p>
<h2 id="validate-sensor-data" class="section-header"><a href="#validate-sensor-data">4.3 Validate Sensor Data</a></h2>
<p>This is how we <strong>validate the Sensor Data Frame</strong>: <a href="https://github.com/lupyuen/ikea_air_quality_sensor/blob/main/ikea_air_quality_sensor_main.c#L79-L102">ikea_air_quality_sensor_main.c</a></p>
<div class="example-wrap"><pre class="language-c"><code>//  Header for Sensor Data Frame
static const uint8_t PM1006_RESPONSE_HEADER[] = { 0x16, 0x11, 0x0B };

//  Return true if we have received a complete and valid Sensor Data Frame
static bool frame_is_valid(void) {

  //  Check the header at frame[0..2]
  if (memcmp(frame, PM1006_RESPONSE_HEADER, sizeof(PM1006_RESPONSE_HEADER)) != 0) {
    //  Header not found
    return false;
  }</code></pre></div>
<p>We verify that the Sensor Data Frame contains the <strong>Header: <code>16 11 0B</code></strong></p>
<p>Next we <strong>sum up all the bytes</strong> in the Sensor Data Frame‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>  //  Compute sum of all bytes in the frame
  uint8_t sum = 0;
  for (int i = 0; i &lt; sizeof(frame); i++) {
    sum += frame[i];
  }</code></pre></div>
<p>(Including the Checksum at the last byte)</p>
<p>And we verify that the <strong>sum is 0</strong>‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>  //  All bytes must add to 0 (because of checksum at the last byte)
  if (sum != 0) {
    //  Invalid checksum
    printf(&quot;\nPM1006 checksum is wrong: %02x, expected zero\n&quot;, sum);
    return false;
  }</code></pre></div>
<p>Now that the Sensor Data Frame is <strong>complete and valid</strong>‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>  //  We have received a complete and valid response frame
  return true;
}</code></pre></div>
<p>We proceed to process the PM 2.5 data inside the frame.</p>
<p><img src="https://lupyuen.github.io/images/ikea-code3.png" alt="Validate Sensor Data" /></p>
<h2 id="process-sensor-data" class="section-header"><a href="#process-sensor-data">4.4 Process Sensor Data</a></h2>
<p>To process the Sensor Data Frame, we extract the <strong>PM 2.5 value</strong> from the frame: <a href="https://github.com/lupyuen/ikea_air_quality_sensor/blob/main/ikea_air_quality_sensor_main.c#L104-L114">ikea_air_quality_sensor_main.c</a></p>
<div class="example-wrap"><pre class="language-c"><code>//  Process the PM 2.5 data in the Sensor Data Frame
static void process_frame(void) {

  //  frame[3..4] is unused
  //  frame[5..6] is our PM2.5 reading
  //  In the datasheet, frame[3..6] is called DF1-DF4:
  //  http://www.jdscompany.co.kr/download.asp?gubun=07&amp;filename=PM1006_LED_PARTICLE_SENSOR_MODULE_SPECIFICATIONS.pdf

  const int pm_2_5_concentration = 
    frame[5] * 256 + 
    frame[6];</code></pre></div>
<p>Right now we‚Äôre not really using the PM 2.5 data‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>  //  TODO: Transmit the sensor data
  printf(&quot;\nGot PM2.5 Concentration: %d ¬µg/m¬≥\n&quot;, pm_2_5_concentration);
}</code></pre></div>
<p>But in the next article we‚Äôll transmit the data wirelessly over <a href="https://makezine.com/2021/05/24/go-long-with-lora-radio/"><strong>LoRaWAN</strong></a> to <a href="https://makezine.com/2021/05/24/go-long-with-lora-radio/"><strong>The Things Network</strong></a>.</p>
<p>(Thanks to the onboard LoRa Transceiver on PineDio Stack)</p>
<p>The code in our NuttX App was inspired by the <a href="https://github.com/Hypfer/esp8266-vindriktning-particle-sensor/blob/master/src/SerialCom.h#L26-L63"><strong>Arduino</strong></a> and <a href="https://github.com/esphome/esphome/blob/dev/esphome/components/pm1006/pm1006.cpp#L57-L96"><strong>ESPHome</strong></a> modules for the IKEA Sensor.</p>
<p><img src="https://lupyuen.github.io/images/ikea-code4.png" alt="Process Sensor Data" /></p>
<h1 id="run-nuttx-app" class="section-header"><a href="#run-nuttx-app">5 Run NuttX App</a></h1>
<p>TODO</p>
<p><img src="https://lupyuen.github.io/images/ikea-code5.png" alt="" /></p>
<h1 id="install-app" class="section-header"><a href="#install-app">6 Install App</a></h1>
<p>TODO</p>
<p>To add this repo to your NuttX project‚Ä¶</p>
<div class="example-wrap"><pre class="language-bash"><code># TODO: Change this to the path of our &quot;incubator-nuttx-apps/examples&quot; folder
pushd nuttx/apps/examples
git submodule add https://github.com/lupyuen/ikea_air_quality_sensor
popd</code></pre></div>
<p>Then update the NuttX Build Config‚Ä¶</p>
<div class="example-wrap"><pre class="language-bash"><code># TODO: Change this to the path of our &quot;incubator-nuttx&quot; folder
cd nuttx/nuttx

# Preserve the Build Config
cp .config ../config

# Erase the Build Config and Kconfig files
make distclean

# For BL602: Configure the build for BL602
./tools/configure.sh bl602evb:nsh

# For ESP32: Configure the build for ESP32.
# TODO: Change &quot;esp32-devkitc&quot; to our ESP32 board.
./tools/configure.sh esp32-devkitc:nsh

# Restore the Build Config
cp ../config .config

# Edit the Build Config
make menuconfig </code></pre></div>
<p>In menuconfig, enable the IKEA Air Quality Sensor App under ‚ÄúApplication Configuration‚Äù ‚Üí ‚ÄúExamples‚Äù.</p>
<h1 id="configure-apache-nuttx-os" class="section-header"><a href="#configure-apache-nuttx-os">7 Configure Apache NuttX OS</a></h1>
<p>TODO</p>
<p>We configure the UART Port on Apache NuttX OS for the IKEA Sensor‚Ä¶</p>
<div class="example-wrap"><pre class="language-bash"><code>make menuconfig</code></pre></div>
<p>Enable UART1:</p>
<ul>
<li>Select ‚ÄúSystem Type ‚Üí BL602 Peripheral Support‚Äù</li>
<li>Check ‚ÄúUART1‚Äù</li>
</ul>
<p>Set to 9600 bps:</p>
<ul>
<li>Select ‚ÄúDevice Drivers ‚Üí Serial Driver Support ‚Üí UART1 Configuration‚Äù</li>
<li>Set ‚ÄúBAUD rate‚Äù to 9600</li>
</ul>
<p>Enable <code>cat</code>:</p>
<ul>
<li>Select ‚ÄúApplication Configuration ‚Üí NSH Library ‚Üí Disable Individual commands‚Äù</li>
<li>Uncheck ‚ÄúDisable cat‚Äù</li>
</ul>
<p>Build and flash NuttX OS to PineDio Stack BL604.</p>
<p>IKEA Sensor is now connected to NuttX OS at <code>/dev/ttyS1</code></p>
<p>TODO14</p>
<p><img src="https://lupyuen.github.io/images/ikea-uart3.png" alt="" /></p>
<h1 id="output-log" class="section-header"><a href="#output-log">8 Output Log</a></h1>
<p>TODO</p>
<p>Run the following command to test the IKEA Sensor on NuttX OS‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>nsh&gt; ikea_air_quality_sensor
16  11  0b  00  00  00  17  00  00  02  ff  00  00  00  21  02  00  00  0b  88
Got PM2.5 Concentration: 23 ¬µg/m¬≥
16  11  0b  00  00  00  17  00  00  02  ff  00  00  00  21  02  00  00  0b  88
Got PM2.5 Concentration: 23 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0b  80
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0b  80
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0b  80
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  03  00  00  00  22  02  00  00  0b  81
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  02  00  00  00  22  02  00  00  0b  82
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  02  00  00  00  22  02  00  00  0b  82
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  02  00  00  00  22  02  00  00  0b  82
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0b  80
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  04  00  00  00  22  02  00  00  0b  80
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  03  00  00  00  22  02  00  00  0b  81
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  03  00  00  00  22  02  00  00  0b  81
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  18  00  00  03  02  00  00  00  22  02  00  00  0b  82
Got PM2.5 Concentration: 24 ¬µg/m¬≥
16  11  0b  00  00  00  17  00  00  03  01  00  00  00  21  02  00  00  0b  85
Got PM2.5 Concentration: 23 ¬µg/m¬≥
16  11  0b  00  00  00  17  00  00  03  00  00  00  00  21  02  00  00  0b  86
Got PM2.5 Concentration: 23 ¬µg/m¬≥</code></pre></div>
<p><a href="https://youtu.be/dUHlG67pB3M">Watch the demo on YouTube</a></p>
<h1 id="test-with-apache-nuttx-os" class="section-header"><a href="#test-with-apache-nuttx-os">9 Test with Apache NuttX OS</a></h1>
<p>TODO</p>
<p>Here‚Äôs a quick way to test the IKEA Sensor with NuttX OS. Enter these NuttX commands to read the UART port and dump the data‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>nsh&gt; ls /dev
/dev:
 console
 gpio0
 gpio1
 gpio2
 null
 spi0
 spitest0
 timer0
 ttyS1
 urandom
 zero
nsh&gt; cat /dev/ttyS1

3(1&gt;
    2&#39;0A
        2%0C
            1$/F
                .,T
                   .,T
                      .
                       .,V
                          .,V
                             -+Y
                                -+Y</code></pre></div>
<p><a href="https://youtu.be/iFf8_f7ExUI">Watch the demo on YouTube</a></p>
<p>To see the binary data, modify the GPS Demo App: <a href="https://github.com/lupyuen/incubator-nuttx-apps/blob/master/examples/gps/gps_main.c">gps_main.c</a>‚Ä¶</p>
<div class="example-wrap"><pre class="language-c"><code>/* Read until we complete a line */
cnt = 0;
do
  {
    read(fd, &amp;ch, 1);
    //  Insert this line to dump the data in hex:
    printf(&quot;%02x  &quot;, ch);</code></pre></div>
<p>Build and run the modified GPS Demo App‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>nsh&gt; gps
00  00  
16  11  0b  00  00  00  39  00  00  03  39  00  00  00  37  01  00  00  00  21  
16  11  0b  00  00  00  2b  00  00  03  17  00  00  00  29  01  00  00  00  5f  
16  11  0b  00  00  00  32  00  00  03  26  00  00  00  30  01  00  00  00  42 
16  11  0b  00  00  00  31  00  00  03  24  00  00  00  2f  01  00  00  00  46  
16  11  0b  00  00  00  31  00  00  03  24  00  00  00  2f  01  00  00  00  46  
16  11  0b  00  00  00  31  00  00  03  23  00  00  00  2f  01  00  00  00  47  
16  11  0b  00  00  00  31  00  00  03  22  00  00  00  2f  01  00  00  00  48  
16  11  0b  00  00  00  30  00  00  03  21  00  00  00  2e  01  00  00  00  4b  
16  11  0b  00  00  00  2f  00  00  03  1f  00  00  00  2d  01  00  00  00  4f  
16  11  0b  00  00  00  2f  00  00  03  1f  00  00  00  2d  01  00  00  00  4f  
16  11  0b  00  00  00  2f  00  00  03  1f  00  00  00  2d  01  00  00  00  4f  
16  11  0b  00  00  00  2f  00  00  03  1e  00  00  00  2d  01  00  00  00  50  
16  11  0b  00  00  00  2f  00  00  03  1e  00  00  00  2d  01  00  00  00  50  
16  11  0b  00  00  00  2f  00  00  03  1d  00  00  00  2d  01  00  00  00  51  
16  11  0b  00  00  00  2e  00  00  03  1c  00  00  00  2c  01  00  00  00  54  
16  11  0b  00  00  00  2e  00  00  03  1c  00  00  00  2c  01  00  00  00  54  
16  11  0b  00  00  00  2e  00  00  03  1c  00  00  00  2c  01  00  00  00  54</code></pre></div>
<p><a href="https://youtu.be/TyG-dJCx8OQ">Watch the demo on YouTube</a></p>
<p>Yep we see the 20-byte frames of Sensor Data, and the PM 2.5 encoded inside!</p>
<p>PM 2.5 = 46 (<code>0x002e</code>)</p>
<p>TODO15</p>
<p><img src="https://lupyuen.github.io/images/ikea-gps.png" alt="" /></p>
<p>TODO16</p>
<p><img src="https://lupyuen.github.io/images/ikea-gps2.png" alt="" /></p>
<h1 id="connect-to-lorawan-and-the-things-network" class="section-header"><a href="#connect-to-lorawan-and-the-things-network">10 Connect to LoRaWAN and The Things Network</a></h1>
<p>TODO</p>
<h1 id="visualise-with-prometheus-and-grafana" class="section-header"><a href="#visualise-with-prometheus-and-grafana">11 Visualise with Prometheus and Grafana</a></h1>
<p>TODO</p>
<h1 id="references" class="section-header"><a href="#references">12 References</a></h1>
<p>TODO</p>
<ul>
<li>
<p><a href="https://style.oversubstance.net/2021/08/diy-use-an-ikea-vindriktning-air-quality-sensor-in-home-assistant-with-esphome/">‚ÄúUse an IKEA VINDRIKTNING air quality sensor in Home Assistant with ESPHome‚Äù</a></p>
</li>
<li>
<p><a href="https://www.ikea.com/us/en/manuals/vindriktning-air-quality-sensor__AA-2289325-1.pdf">IKEA VINDRIKTNING Manual</a></p>
</li>
</ul>
<h1 id="whats-next" class="section-header"><a href="#whats-next">13 What‚Äôs Next</a></h1>
<p>TODO</p>
<p>Many Thanks to my <a href="https://github.com/sponsors/lupyuen"><strong>GitHub Sponsors</strong></a> for supporting my work! This article wouldn‚Äôt have been possible without your support.</p>
<ul>
<li>
<p><a href="https://github.com/sponsors/lupyuen">Sponsor me a coffee</a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io/articles/book">Read ‚ÄúThe RISC-V BL602 / BL604 Book‚Äù</a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io">Check out my articles</a></p>
</li>
<li>
<p><a href="https://lupyuen.github.io/rss.xml">RSS Feed</a></p>
</li>
</ul>
<p><em>Got a question, comment or suggestion? Create an Issue or submit a Pull Request here‚Ä¶</em></p>
<p><a href="https://github.com/lupyuen/lupyuen.github.io/blob/master/src/ikea.md"><code>lupyuen.github.io/src/ikea.md</code></a></p>
<h1 id="notes" class="section-header"><a href="#notes">14 Notes</a></h1>
<ol>
<li>
<p>This article is the expanded version of <a href="https://twitter.com/MisterTechBlog/status/1490147828458405889">this Twitter Thread</a></p>
</li>
<li>
<p>According to the PM1006 Datasheet, the UART Port runs at <a href="https://lupyuen.github.io/articles/ikea#about-ikea-air-quality-sensor"><strong>4.5V Logic Level</strong></a> (instead of 3.3V). Don‚Äôt we need a <a href="https://learn.sparkfun.com/tutorials/voltage-dividers/all"><strong>Voltage Divider</strong></a> to protect our microcontroller, which is not 5V Tolerant?</p>
<p>Apparently some folks are using the UART Port just fine without a Voltage Divider. <a href="https://github.com/Hypfer/esp8266-vindriktning-particle-sensor/issues/44">(See this)</a></p>
<p>But to be really safe we ought to use a Voltage Divider.</p>
</li>
</ol>
<h1 id="appendix-solder-uart-port-on-ikea-vindriktning-air-quality-sensor" class="section-header"><a href="#appendix-solder-uart-port-on-ikea-vindriktning-air-quality-sensor">15 Appendix: Solder UART Port on IKEA VINDRIKTNING Air Quality Sensor</a></h1>
<p>TODO</p>
<p>Use very fine Solder Wire for tiny blobs of solder</p>
<p>22 AWG Solid Core Wire</p>
<p>TODO7</p>
<p><img src="https://lupyuen.github.io/images/ikea-solder.jpg" alt="" /></p>
<p>TODO8: Cover with Sticky Tape</p>
<p><img src="https://lupyuen.github.io/images/ikea-solder2.jpg" alt="" /></p>
<p>TODO11: Solder the REST Pad</p>
<p>Drop a tiny blob of molten solder on the REST Pad</p>
<p>Place the wire on top of the solder blob (now hardened)</p>
<p>Gently tap our Soldering Iron on top of the wire</p>
<p>The wire should sink into the molten blob</p>
<p>Quickly adjust the wire to make sure it doesn‚Äôt touch any components on the Circuit Board</p>
<p>When cooled, the wire stays in the hardened blob</p>
<p><img src="https://lupyuen.github.io/images/ikea-solder5.jpg" alt="" /></p>
<p>TODO9: Cover the REST Pad. Solder the GND Pad.</p>
<p><img src="https://lupyuen.github.io/images/ikea-solder3.jpg" alt="" /></p>
<p>TODO10: Result</p>
<p><img src="https://lupyuen.github.io/images/ikea-solder4.jpg" alt="" /></p>
<h1 id="appendix-test-with-bus-pirate" class="section-header"><a href="#appendix-test-with-bus-pirate">16 Appendix: Test with Bus Pirate</a></h1>
<p>TODO</p>
<p>Before testing with Apache NuttX OS, we sniffed the IKEA Sensor‚Äôs UART Port with Bus Pirate. Connect Bus Pirate to IKEA Sensor as follows‚Ä¶</p>
<div><table><thead><tr><th align="left">Bus Pirate</th><th align="center">IKEA Sensor</th><th align="left">Wire Colour</th></tr></thead><tbody>
<tr><td align="left">Data In (MISO)</td><td align="center">REST</td><td align="left">Blue</td></tr>
<tr><td align="left">GND</td><td align="center">GND</td><td align="left">Black</td></tr>
</tbody></table>
</div>
<p>Connect USB Ports of IKEA Sensor and Bus Pirate to the same computer. Remember: Only One Power Source!</p>
<p>Enter these Bus Pirate commands to capture the UART output from IKEA Sensor (9600 bps, 8 bits, no parity, 1 stop bit)‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>HiZ&gt;m
1. HiZ
2. 1-WIRE
3. UART
4. I2C
5. SPI
6. 2WIRE
7. 3WIRE
8. KEYB
9. LCD
10. PIC
11. DIO
x. exit(without change)

(1)&gt;3
Set serial port speed: (bps)
 1. 300
 2. 1200
 3. 2400
 4. 4800
 5. 9600
 6. 19200
 7. 38400
 8. 57600
 9. 115200
10. Input Custom BAUD
11. Auto-Baud Detection (Activity Required)

(1)&gt;5
Data bits and parity:
 1. 8, NONE *default 
 2. 8, EVEN 
 3. 8, ODD 
 4. 9, NONE
(1)&gt;
Stop bits:
 1. 1 *default
 2. 2
(1)&gt;
Receive polarity:
 1. Idle 1 *default
 2. Idle 0
(1)&gt;
Select output type:
 1. Open drain (H=Hi-Z, L=GND)
 2. Normal (H=3.3V, L=GND)

(1)&gt;
Clutch disengaged!!!
To finish setup, start up the power supplies with command &#39;W&#39;

Ready
UART&gt;W
POWER SUPPLIES ON
Clutch engaged!!!</code></pre></div>
<p><a href="https://youtu.be/QOJF6hAhFv4">Watch the demo on YouTube</a></p>
<p>See below for the ASCII and Binary Logs.</p>
<p><a href="http://dangerousprototypes.com/docs/UART">(More about Bus Pirate interfacing with UART)</a></p>
<h2 id="ascii-log" class="section-header"><a href="#ascii-log">16.1 ASCII Log</a></h2>
<p>TODO</p>
<p>ASCII Log of UART Output from IKEA Sensor‚Ä¶</p>
<p><a href="https://youtu.be/QOJF6hAhFv4">Watch the demo on YouTube</a></p>
<div class="example-wrap"><pre class="language-text"><code>UART&gt;(2)
Raw UART input
Any key to exit

&lt;@:
   &lt;B:
[6C:;8
[9C:;8
[12C9:7 
[16C997!
[20C987&quot;
[24C876%
[28C876%
[32C876%
[36C866&amp;
[40C856&#39;
[44C745*
[48C745*
[52C745*
[56C745*
[60C735+
[64C614/
[68C614/
[72C614/
[76C614/
[79C
[37;80H 624.
[4C624.
[8C624.
[12C614/
[16C614/
[20C614/
[24C6040
[28C6040
[32C5/33
[36C5.34
[40C4,28
[44C4,28
[48C5-35
[52C5.34
[56C5.34
[60C5-35
[64C4,28
[68C2%0C
[72C2%0C
[76C2&amp;0B
[79C
[37;80H 2&#39;0A
[4C3)1=
[8C3*1&lt;
[12C4+29</code></pre></div>
<p><a href="https://gist.github.com/lupyuen/f40454dda8e3d7f279fb6ef721add465">(See the complete log)</a></p>
<h2 id="binary-log" class="section-header"><a href="#binary-log">16.2 Binary Log</a></h2>
<p>TODO</p>
<p>Binary Log of UART Output from IKEA Sensor‚Ä¶</p>
<div class="example-wrap"><pre class="language-text"><code>UART&gt;{
UART LIVE DISPLAY, } TO STOP
UART&gt;
READ: -f 0x00
UART&gt;
READ: -f 0x00
UART&gt;
READ: -f 0x00
UART&gt;
READ: 0x16
UART&gt;
READ: 0x11
UART&gt;
READ: 0x0B
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;
READ: 0x3D
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;
READ: 0x03
UART&gt;
READ: 0x45
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;
READ: 0x3B
UART&gt;
READ: 0x01
UART&gt;
READ: 0x00
UART&gt;
READ: 0x00
UART&gt;</code></pre></div>
<p><a href="https://gist.github.com/lupyuen/db0c97b12bd1070e17cd2e570a5aa810">(See the complete log)</a></p>
<p><a href="https://gist.github.com/lupyuen/ebe4c0628fc9ea2e124e6f00d8246b49">(Another binary log)</a></p>
<p>TODO12</p>
<p><img src="https://lupyuen.github.io/images/ikea-buspirate.jpg" alt="IKEA VINDRIKTNING Air Quality Sensor connected to Bus Pirate" /></p>
<p>TODO13</p>
<p><img src="https://lupyuen.github.io/images/ikea-buspirate2.png" alt="" /></p>
<p>TODO</p>
<p><img src="https://lupyuen.github.io/images/ikea-trek.png" alt="Trekking 13 km to IKEA on the horizon in search of VINDRIKTNING" /></p>
<p><em>Trekking 13 km to IKEA on the horizon in search of VINDRIKTNING</em></p>

    
</body>
</html>